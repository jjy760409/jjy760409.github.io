
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AgriNexus Admin Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f8f9fa; }
    h1 { color: #198754; }
    .log { background: white; border-radius: 10px; padding: 10px; margin: 10px 0; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .uid { font-weight: bold; color: #333; }
    .msg { margin-top: 4px; }
    #loginBtn { padding: 10px 20px; font-weight: bold; background: #198754; color: white; border: none; border-radius: 8px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ğŸ“Š AgriNexus ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
  <button id="loginBtn" onclick="login()">ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸ (Google)</button>
  <div id="logs" style="margin-top:20px;"></div>
  <canvas id="langChart" width="400" height="200"></canvas>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDemoKey00000000000000000000000000",
      authDomain: "agrinexus-demo.firebaseapp.com",
      databaseURL: "https://agrinexus-demo-default-rtdb.firebaseio.com",
      projectId: "agrinexus-demo",
      storageBucket: "agrinexus-demo.appspot.com",
      messagingSenderId: "000000000000",
      appId: "1:000000000000:web:demoapp"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    function login() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then((result) => {
          const user = result.user;
          if (!user.email.endsWith("@agrinexus.com")) {
            alert("ê´€ë¦¬ì ì „ìš© ì ‘ê·¼ì…ë‹ˆë‹¤.");
            return;
          }
          document.getElementById("loginBtn").style.display = "none";
          loadLogs();
        }).catch((error) => {
          console.error(error);
          alert("ë¡œê·¸ì¸ ì‹¤íŒ¨: " + error.message);
        });
    }

    function loadLogs() {
      db.ref("agrinexus_chat").on("value", snapshot => {
        const logsDiv = document.getElementById("logs");
        logsDiv.innerHTML = "";
        const data = snapshot.val();
        const langStats = { en: 0, ko: 0, ja: 0 };
        for (let uid in data) {
          const userLogs = data[uid];
          for (let key in userLogs) {
            const entry = userLogs[key];
            langStats[entry.lang] = (langStats[entry.lang] || 0) + 1;
            const log = document.createElement("div");
            log.className = "log";
            log.innerHTML = `
              <div class="uid">ğŸ‘¤ ì‚¬ìš©ì: ${uid}</div>
              <div class="msg"><strong>${entry.sender}:</strong> ${entry.message}</div>
              <div class="msg">ğŸŒ ì–¸ì–´: ${entry.lang || "N/A"}</div>
            `;
            logsDiv.appendChild(log);
          }
        }
        drawChart(langStats);
      });
    }

    function drawChart(stats) {
      const ctx = document.getElementById("langChart").getContext("2d");
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['English', 'Korean', 'Japanese'],
          datasets: [{
            label: 'ì§ˆë¬¸/ì‘ë‹µ ê±´ìˆ˜',
            data: [stats.en || 0, stats.ko || 0, stats.ja || 0],
            backgroundColor: ['#4caf50', '#2196f3', '#ff9800']
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }
  </script>

<div style="margin-top: 40px;">
  <h2>ğŸ§  GPT ê¸°ë°˜ ì§ˆë¬¸ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜</h2>
  <button onclick="categorizeQuestions()" style="padding:10px;background:#333;color:white;border:none;border-radius:6px;">AIë¡œ ì§ˆë¬¸ ë¶„ë¥˜</button>
  <div id="categoryResults" style="margin-top:20px;"></div>
</div>

<script>
async function categorizeQuestions() {
  const logs = document.querySelectorAll(".log .msg strong");
  const messages = Array.from(logs).map(log => log.parentElement.textContent).slice(0, 10).join("\n");

  if (!messages) {
    alert("ë¶„ì„í•  ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  const prompt = `
ë‹¤ìŒ ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ê° ì§ˆë¬¸ì„ ì•„ë˜ì™€ ê°™ì€ ì¹´í…Œê³ ë¦¬ ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•´ ì£¼ì„¸ìš”:
[ì„¤ê³„, ì¬ë°°, ë¬¼ë¥˜, ìˆ˜ì¶œì…, ë¬¸ì„œ, ê¸°íƒ€]
í˜•ì‹: ì§ˆë¬¸ â†’ ì¹´í…Œê³ ë¦¬

ì§ˆë¬¸ ëª©ë¡:
${messages}
  `;

  document.getElementById("categoryResults").innerText = "AI ë¶„ì„ ì¤‘...";

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("categoryResults").innerText = data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("categoryResults").innerText = "âŒ ë¶„ì„ ì‹¤íŒ¨";
  }
}
</script>

<div style="margin-top: 30px;">
  <button onclick="exportCSV()" style="padding:8px 16px;margin-right:10px;">ğŸ“„ CSV ì €ì¥</button>
  <button onclick="exportPDF()" style="padding:8px 16px;">ğŸ§¾ PDF ì €ì¥</button>
</div>

<canvas id="categoryChart" width="400" height="200" style="margin-top:30px;"></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
function exportCSV() {
  const content = document.getElementById("categoryResults").innerText;
  const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "category_analysis.csv";
  a.click();
}

function exportPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const content = document.getElementById("categoryResults").innerText;
  const lines = content.split('\n');
  lines.forEach((line, i) => doc.text(line, 10, 10 + i * 10));
  doc.save("category_analysis.pdf");
}

function drawCategoryChartFromText() {
  const text = document.getElementById("categoryResults").innerText;
  const lines = text.split("\n");
  const counts = {
    ì„¤ê³„: 0, ì¬ë°°: 0, ë¬¼ë¥˜: 0, ìˆ˜ì¶œì…: 0, ë¬¸ì„œ: 0, ê¸°íƒ€: 0
  };
  lines.forEach(line => {
    for (let key in counts) {
      if (line.includes(key)) counts[key]++;
    }
  });

  const ctx = document.getElementById("categoryChart").getContext("2d");
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: Object.keys(counts),
      datasets: [{
        label: 'ì¹´í…Œê³ ë¦¬ë³„ ì§ˆë¬¸ ìˆ˜',
        data: Object.values(counts),
        backgroundColor: '#198754'
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}
</script>

<script>
const observeCategory = new MutationObserver(drawCategoryChartFromText);
observeCategory.observe(document.getElementById("categoryResults"), { childList: true });
</script>


<div style="margin-top: 40px;">
  <h2>ğŸ” ìœ ì‚¬ ì§ˆë¬¸ ì¶”ì²œ</h2>
  <input type="text" id="similarInput" placeholder="ë¹„êµí•  ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”" style="width:80%;padding:8px;">
  <button onclick="recommendSimilar()" style="padding:8px 16px;">ì¶”ì²œ ë³´ê¸°</button>
  <div id="similarResults" style="margin-top:15px;font-size:0.9rem;"></div>
</div>

<script>
async function recommendSimilar() {
  const query = document.getElementById("similarInput").value.trim();
  if (!query) return alert("ë¹„êµí•  ì§ˆë¬¸ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  const allLogs = Array.from(document.querySelectorAll(".log .msg strong"))
    .map(log => log.parentElement.textContent)
    .filter(q => !q.includes("AgriBot"))
    .slice(0, 20).join("\n");

  const prompt = `
ì•„ë˜ì— ê¸°ì¡´ ì§ˆë¬¸ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì¤‘ì—ì„œ ì…ë ¥ëœ ì§ˆë¬¸ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ì§ˆë¬¸ 3ê°œë¥¼ ì°¾ì•„ ì¶”ì²œí•´ ì£¼ì„¸ìš”.

ì…ë ¥ ì§ˆë¬¸:
"${query}"

ê¸°ì¡´ ì§ˆë¬¸ë“¤:
${allLogs}
`;

  document.getElementById("similarResults").innerText = "ğŸ”„ ìœ ì‚¬ ì§ˆë¬¸ ë¶„ì„ ì¤‘...";

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("similarResults").innerText = "âœ… ì¶”ì²œ:
" + data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("similarResults").innerText = "âŒ ì¶”ì²œ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">

<h2>ğŸ“‚ ì¹´í…Œê³ ë¦¬ í•„í„°ë§</h2>
<select id="categoryFilter" onchange="filterByCategory()" style="padding:6px;">
  <option value="all">ì „ì²´</option>
  <option value="ì„¤ê³„">ì„¤ê³„</option>
  <option value="ì¬ë°°">ì¬ë°°</option>
  <option value="ë¬¼ë¥˜">ë¬¼ë¥˜</option>
  <option value="ìˆ˜ì¶œì…">ìˆ˜ì¶œì…</option>
  <option value="ë¬¸ì„œ">ë¬¸ì„œ</option>
  <option value="ê¸°íƒ€">ê¸°íƒ€</option>
</select>

<script>
function filterByCategory() {
  const value = document.getElementById("categoryFilter").value;
  const lines = document.getElementById("categoryResults").innerText.split("\n");
  const filtered = value === "all" ? lines : lines.filter(l => l.includes(value));
  document.getElementById("categoryResults").innerText = filtered.join("\n");
}
</script>

<hr style="margin:40px 0;">

<h2>ğŸ“† ì´ìš© í†µê³„ (ê¸°ê°„ í•„í„°)</h2>
<select id="periodFilter" onchange="filterStatsByPeriod()" style="padding:6px;">
  <option value="all">ì „ì²´</option>
  <option value="day">ìµœê·¼ 1ì¼</option>
  <option value="week">ìµœê·¼ 7ì¼</option>
</select>

<div id="periodStats" style="margin-top:10px;"></div>

<script>
function filterStatsByPeriod() {
  const range = document.getElementById("periodFilter").value;
  const logs = Array.from(document.querySelectorAll(".log .msg")).map(e => ({
    text: e.innerText,
    time: Date.now() // simulate time since Firebase does not show timestamps here
  }));
  let filtered = logs;
  if (range === "day") {
    const limit = Date.now() - 24*60*60*1000;
    filtered = logs.filter(l => l.time > limit);
  } else if (range === "week") {
    const limit = Date.now() - 7*24*60*60*1000;
    filtered = logs.filter(l => l.time > limit);
  }
  document.getElementById("periodStats").innerText = "ì´ " + filtered.length + "ê±´ ë¶„ì„ë¨ (ì„ì‹œ ì‹œë®¬ë ˆì´ì…˜ ê¸°ì¤€)";
}
</script>

<hr style="margin:40px 0;">

<h2>ğŸ“ˆ ì§ˆë¬¸ ìˆœìœ„ ê¸°ë°˜ ì¶”ì²œ</h2>
<button onclick="showTopQuestions()" style="padding:8px 16px;">ìƒìœ„ ì§ˆë¬¸ ë³´ê¸°</button>
<div id="topQuestions" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function showTopQuestions() {
  const questions = Array.from(document.querySelectorAll(".log .msg")).map(e => e.innerText.trim());
  const freq = {};
  questions.forEach(q => {
    if (!q.includes("AgriBot")) {
      freq[q] = (freq[q] || 0) + 1;
    }
  });
  const sorted = Object.entries(freq).sort((a,b) => b[1] - a[1]).slice(0, 5);
  const topText = sorted.map(([q,c], i) => `#${i+1} (${c}íšŒ): ${q}`).join("\n");
  document.getElementById("topQuestions").innerText = topText;
}
</script>


<hr style="margin:40px 0;">

<h2>ğŸ§ª GPT ë¶„ë¥˜ ì •í™•ë„ í”¼ë“œë°±</h2>
<p>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ GPT ë¶„ë¥˜ ê²°ê³¼ì— ëŒ€í•œ ì •í™•ë„ë¥¼ 1~5ì ìœ¼ë¡œ í‰ê°€í•´ ì£¼ì„¸ìš”.</p>
<div id="feedbackRating">
  <button onclick="submitFeedback(1)">â­</button>
  <button onclick="submitFeedback(2)">â­â­</button>
  <button onclick="submitFeedback(3)">â­â­â­</button>
  <button onclick="submitFeedback(4)">â­â­â­â­</button>
  <button onclick="submitFeedback(5)">â­â­â­â­â­</button>
</div>
<div id="feedbackStatus" style="margin-top:10px;color:green;"></div>

<script>
function submitFeedback(score) {
  const uid = "admin-feedback";
  const time = Date.now();
  const feedback = {
    score,
    timestamp: time
  };
  firebase.database().ref("agrinexus_feedback/" + uid + "/" + time).set(feedback);
  document.getElementById("feedbackStatus").innerText = `ê°ì‚¬í•©ë‹ˆë‹¤. (${score}ì  ì œì¶œë¨)`;
}
</script>

<hr style="margin:40px 0;">

<h2>ğŸ”„ Google Sheets ì—°ë™</h2>
<p>ë¶„ì„ ê²°ê³¼ ë˜ëŠ” ì§ˆë¬¸ ë¡œê·¸ë¥¼ Google Sheetsë¡œ ë‚´ë³´ë‚´ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?</p>
<button onclick="exportToSheets()" style="padding:8px 16px;">ğŸ“¤ ì‹œíŠ¸ë¡œ ë‚´ë³´ë‚´ê¸°</button>
<div id="sheetExportStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function exportToSheets() {
  document.getElementById("sheetExportStatus").innerText = "ğŸ”„ Google Sheetsë¡œ ë‚´ë³´ë‚´ëŠ” ì¤‘...";
  try {
    // ì•„ë˜ ìš”ì²­ì€ ì‹¤ì œ ì—°ë™ ì‹œ ì„œë²„ë¦¬ìŠ¤ Firebase Functions ë˜ëŠ” AppScript API í•„ìš”
    // ì—¬ê¸°ì„œëŠ” ë°ëª¨ URLë¡œ ëŒ€ì²´
    const response = await fetch("https://sheet.googleapis.com/v4/spreadsheets/fake-export-endpoint", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer FAKE_API_KEY"
      },
      body: JSON.stringify({
        values: document.getElementById("categoryResults").innerText.split("\n")
      })
    });
    if (response.ok) {
      document.getElementById("sheetExportStatus").innerText = "âœ… Google Sheetsë¡œ ì„±ê³µì ìœ¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤.";
    } else {
      throw new Error("ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨");
    }
  } catch (e) {
    document.getElementById("sheetExportStatus").innerText = "âŒ Google Sheets ì—°ë™ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (API ì„¤ì • í•„ìš”)";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“Š í”¼ë“œë°± ì ìˆ˜ í†µê³„ ì‹œê°í™”</h2>
<button onclick="drawFeedbackChart()" style="padding:8px 16px;">ğŸ“ˆ í†µê³„ ë³´ê¸°</button>
<canvas id="feedbackChart" width="400" height="200" style="margin-top:20px;"></canvas>

<script>
function drawFeedbackChart() {
  firebase.database().ref("agrinexus_feedback/admin-feedback").once("value", snapshot => {
    const data = snapshot.val();
    const scores = [0, 0, 0, 0, 0];
    for (let key in data) {
      const s = data[key].score;
      if (s >= 1 && s <= 5) scores[s - 1]++;
    }
    const ctx = document.getElementById("feedbackChart").getContext("2d");
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['â­1', 'â­2', 'â­3', 'â­4', 'â­5'],
        datasets: [{
          label: 'ì œì¶œëœ í”¼ë“œë°± ìˆ˜',
          data: scores,
          backgroundColor: '#ffc107'
        }]
      },
      options: {
        scales: { y: { beginAtZero: true } }
      }
    });
  });
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“¤ ì‹¤ì—°ë™ìš© Google Sheets App Script ì½”ë“œ</h2>
<pre style="background:#eee;padding:10px;font-size:0.8rem;overflow-x:auto;">
function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  data.values.forEach(row => {
    sheet.appendRow([new Date(), row]);
  });
  return ContentService.createTextOutput("success");
}
</pre>

<p>ğŸ“ ìœ„ ì½”ë“œë¥¼ Google Apps Scriptì— ë¶™ì—¬ë„£ê³  ì›¹ì•±ìœ¼ë¡œ ë°°í¬í•˜ì„¸ìš”.<br>
ì‚¬ìš© ê¶Œí•œ: ëˆ„êµ¬ë‚˜ ì ‘ê·¼ / POST ìš”ì²­ í—ˆìš©</p>

<hr style="margin:40px 0;">
<h2>ğŸ§  ì‚¬ìš©ì ì§ˆë¬¸ ê¸°ë°˜ AI ë³´ì • ìš”ì²­</h2>
<p>GPTê°€ ë¶€ì •í™•í•œ ë¶„ë¥˜ë¥¼ í–ˆë‹¤ë©´ ì•„ë˜ì— ë³´ì • ìš”ì²­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.</p>
<textarea id="aiCorrection" rows="3" style="width:100%;padding:8px;"></textarea><br>
<button onclick="submitCorrection()" style="margin-top:10px;padding:8px 16px;">ë³´ì • ìš”ì²­ ì œì¶œ</button>
<div id="correctionStatus" style="margin-top:10px;color:green;"></div>

<script>
function submitCorrection() {
  const text = document.getElementById("aiCorrection").value.trim();
  if (!text) return alert("ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  const time = Date.now();
  firebase.database().ref("agrinexus_training").push({
    correction: text,
    timestamp: time
  });
  document.getElementById("correctionStatus").innerText = "âœ… ë³´ì • ìš”ì²­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.";
  document.getElementById("aiCorrection").value = "";
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“„ ìˆ˜ì¶œì… ë¬¸ì„œ ë° ê³„ì•½ì„œ ìë™í™” ì‹œìŠ¤í…œ</h2>
<p>ìˆ˜ì¶œì…ì— í•„ìš”í•œ ë¬¸ì„œ ìƒì„±, ë²ˆì—­, ì§„ë‹¨, ê³„ì•½ì„œ ì˜¤ë¥˜ ê²€í†  ë“± ìë™í™” ì§€ì›.</p>
<button onclick="startAutoDocumentSystem()" style="padding:10px 20px;">ğŸš€ ìë™ ë¬¸ì„œ ë¶„ì„ ì‹¤í–‰</button>
<div id="docAutomationResults" style="margin-top:15px;font-size:0.9rem;"></div>

<script>
async function startAutoDocumentSystem() {
  const prompt = `
ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ìë™í™”í•©ë‹ˆë‹¤:
1. ìˆ˜ì¶œì… ë¬¸ì„œ/ê³„ì•½ì„œì— ëŒ€í•œ ìë™ ìƒì„± ë° êµ­ê°€ë³„ ì–¸ì–´ ë²ˆì—­
2. ë²•ë¥ ì  í‘œí˜„ê³¼ í•­ëª©ì˜ ëˆ„ë½ ì—¬ë¶€ ìë™ ì§„ë‹¨
3. ì˜ëª»ëœ ì‘ì„± ì˜ˆì‹œ ê°ì§€ ë° ì¶”ì²œ ìˆ˜ì •ì•ˆ ì œì‹œ
4. ì‚¬ìš©ì ì§ˆë¬¸ì— ê¸°ë°˜í•œ CS ëŒ€ì‘ ìë™í™”

ì˜ˆì‹œ ë¬¸ì„œ:
- ìˆ˜ì¶œê³„ì•½ì„œ, ì†¡ì¥, ì„¸ê´€ì‹ ê³ ì„œ ë“±
- ì‘ì„± ì˜¤ë¥˜ ì˜ˆ: ì„œëª… ëˆ„ë½, ë‚ ì§œ ì˜¤ë¥˜, ë¬¸ì¥ ë¶ˆì¼ì¹˜

ìœ„ ê¸°ëŠ¥ì„ ê¸°ë°˜ìœ¼ë¡œ ìŠ¤ë§ˆíŠ¸ ë¬¸ì„œ ì‹œìŠ¤í…œ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì„¸ìš”. ê° í•­ëª©ì€ ìƒì„¸í•˜ê²Œ ê¸°ìˆ í•´ ì£¼ì„¸ìš”.
  `;

  document.getElementById("docAutomationResults").innerText = "ğŸ“„ ìë™í™” ë³´ê³ ì„œ ìƒì„± ì¤‘...";

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("docAutomationResults").innerText = "âœ… ìë™í™” ë¶„ì„ ê²°ê³¼:
" + data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("docAutomationResults").innerText = "âŒ ìë™ ë¶„ì„ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸŒ êµ­ê°€ë³„ ìˆ˜ì¶œì… ë¬¸ì„œ ìë™ ì•ˆë‚´ ì‹œìŠ¤í…œ</h2>
<p>ìˆ˜ì¶œì…í•˜ë ¤ëŠ” êµ­ê°€ë¥¼ ì„ íƒí•˜ë©´ í•„ìš”í•œ í•„ìˆ˜ ë¬¸ì„œì™€ ì¤€ë¹„ì‚¬í•­ì„ ì‹¤ì‹œê°„ ì•ˆë‚´í•©ë‹ˆë‹¤.</p>

<select id="countrySelector" style="padding:8px;">
  <option value="United States">ğŸ‡ºğŸ‡¸ ë¯¸êµ­</option>
  <option value="Korea">ğŸ‡°ğŸ‡· ëŒ€í•œë¯¼êµ­</option>
  <option value="Japan">ğŸ‡¯ğŸ‡µ ì¼ë³¸</option>
  <option value="Germany">ğŸ‡©ğŸ‡ª ë…ì¼</option>
  <option value="China">ğŸ‡¨ğŸ‡³ ì¤‘êµ­</option>
</select>

<input type="text" id="productInfo" placeholder="ì œí’ˆ ë˜ëŠ” ì„œë¹„ìŠ¤ ì…ë ¥" style="padding:8px;width:300px;" />
<button onclick="fetchCountryDocs()" style="padding:8px 16px;">ğŸ“„ ë¬¸ì„œ í™•ì¸</button>

<div id="countryDocResults" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function fetchCountryDocs() {
  const country = document.getElementById("countrySelector").value;
  const product = document.getElementById("productInfo").value.trim();
  if (!product) return alert("ì œí’ˆ ë˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("countryDocResults").innerText = "ğŸ“¦ ë¬¸ì„œ ì •ë³´ ë¡œë”© ì¤‘...";

  const prompt = `
"${country}"ë¡œ "${product}"ë¥¼ ìˆ˜ì¶œ/ìˆ˜ì…í•˜ë ¤ëŠ” ê²½ìš°,
í•„ìˆ˜ë¡œ ì¤€ë¹„í•´ì•¼ í•  ì„œë¥˜, í†µê´€ ë¬¸ì„œ, ê³„ì•½ì„œ í•­ëª©, ì£¼ì˜ì‚¬í•­, ì œë„ ì°¨ì´ ë“±ì„ ë‹¤ìŒ í•­ëª©ì— ë”°ë¼ ì•ˆë‚´í•´ ì£¼ì„¸ìš”:

1. í•„ìˆ˜ ìˆ˜ì¶œì… ë¬¸ì„œ
2. ê³„ì•½ì„œ í•„ìˆ˜ í•­ëª©
3. í†µê´€ ë° ì„¸ê´€ ìš”ê±´
4. êµ­ê°€ë³„ ì–¸ì–´ ë²ˆì—­ í•„ìš” ì—¬ë¶€
5. ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ ë° ì‚¬ì „ ì¤€ë¹„ ì²´í¬ë¦¬ìŠ¤íŠ¸
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("countryDocResults").innerText = data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("countryDocResults").innerText = "âŒ êµ­ê°€ë³„ ë¬¸ì„œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“ ê³„ì•½ì„œ ìë™ ì™„ì„± ì‹œìŠ¤í…œ</h2>
<p>ì œí’ˆ ë˜ëŠ” ì„œë¹„ìŠ¤ì™€ êµ­ê°€ë¥¼ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ë§ì¶¤í˜• ê³„ì•½ì„œ í…œí”Œë¦¿ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>

<input type="text" id="contractProduct" placeholder="ì œí’ˆ ë˜ëŠ” ì„œë¹„ìŠ¤ ì…ë ¥" style="padding:8px;width:300px;" />
<select id="contractCountry" style="padding:8px;">
  <option value="United States">ğŸ‡ºğŸ‡¸ ë¯¸êµ­</option>
  <option value="Korea">ğŸ‡°ğŸ‡· í•œêµ­</option>
  <option value="Japan">ğŸ‡¯ğŸ‡µ ì¼ë³¸</option>
  <option value="Germany">ğŸ‡©ğŸ‡ª ë…ì¼</option>
  <option value="China">ğŸ‡¨ğŸ‡³ ì¤‘êµ­</option>
</select>
<button onclick="generateContract()" style="padding:8px 16px;">ğŸ“„ ê³„ì•½ì„œ ìƒì„±</button>

<div id="contractResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function generateContract() {
  const product = document.getElementById("contractProduct").value.trim();
  const country = document.getElementById("contractCountry").value;

  if (!product) return alert("ì œí’ˆ ë˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("contractResult").innerText = "ğŸ“„ ê³„ì•½ì„œ ìƒì„± ì¤‘...";

  const prompt = `
"${country}" êµ­ê°€ì— "${product}"ë¥¼ ìˆ˜ì¶œì…í•˜ê¸° ìœ„í•œ êµ­ì œ í‘œì¤€ ê³„ì•½ì„œë¥¼ ìë™ìœ¼ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”.
ê³„ì•½ì„œëŠ” ë‹¤ìŒ í•­ëª©ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:
- ê±°ë˜ ë‹¹ì‚¬ì ì •ë³´
- í’ˆëª©ëª…, ìˆ˜ëŸ‰, ê°€ê²© ì¡°ê±´
- ì§€ë¶ˆ ì¡°ê±´ ë° ì¼ì •
- ì¸ì½”í…€ì¦ˆ ì¡°ê±´ (ì˜ˆ: FOB, CIF)
- í†µê´€ ë° ë³´í—˜ ì±…ì„
- ì„œëª…ë€
ë‚´ìš©ì€ ê³µì‹ì ì´ê³  ë²•ì  íš¨ë ¥ì´ ìˆë„ë¡ êµ¬ì„±í•´ ì£¼ì„¸ìš”.
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("contractResult").innerText = data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("contractResult").innerText = "âŒ ê³„ì•½ì„œ ìƒì„± ì‹¤íŒ¨";
  }
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“¦ HS ì½”ë“œ (ì„¸ê´€ ì½”ë“œ) ì¶”ì²œ ì‹œìŠ¤í…œ</h2>
<p>ì œí’ˆì„ ì…ë ¥í•˜ë©´ ìˆ˜ì¶œì… ì‹œ í•„ìš”í•œ ê´€ì„¸ë¶„ë¥˜ì½”ë“œ(HS Code)ë¥¼ ìë™ ì¶”ì²œí•©ë‹ˆë‹¤.</p>

<input type="text" id="hsProduct" placeholder="ì œí’ˆ ì…ë ¥ (ì˜ˆ: LED ì¡°ëª…, í† ë§ˆí†  ë“±)" style="padding:8px;width:300px;" />
<button onclick="recommendHSCode()" style="padding:8px 16px;">ğŸ“Œ ì½”ë“œ ì¶”ì²œ</button>

<div id="hsCodeResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function recommendHSCode() {
  const product = document.getElementById("hsProduct").value.trim();
  if (!product) return alert("ì œí’ˆì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("hsCodeResult").innerText = "ğŸ” HS ì½”ë“œ ì¡°íšŒ ì¤‘...";

  const prompt = `
"${product}"ì— í•´ë‹¹í•˜ëŠ” ìµœì‹  êµ­ì œ í†µì¼ ê´€ì„¸ë¶„ë¥˜ì½”ë“œ(HS Code)ë¥¼ ì•Œë ¤ ì£¼ì„¸ìš”.
ê°€ëŠ¥í•œ ê²½ìš° 6ìë¦¬ ì½”ë“œ ê¸°ì¤€ìœ¼ë¡œ ì œê³µí•´ ì£¼ì„¸ìš”.
ì˜ˆ: 0702.00 - í† ë§ˆí† (ì‹ ì„  ë˜ëŠ” ëƒ‰ì¥)
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("hsCodeResult").innerText = data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("hsCodeResult").innerText = "âŒ HS ì½”ë“œ ì¡°íšŒ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“¤ ê³„ì•½ì„œ PDF ë‹¤ìš´ë¡œë“œ ë° ì´ë©”ì¼ ì „ì†¡</h2>
<p>ê³„ì•½ì„œê°€ ìƒì„±ë˜ë©´ ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ PDF ë‹¤ìš´ë¡œë“œ ë˜ëŠ” ì´ë©”ì¼ ì „ì†¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<button onclick="downloadContractPDF()" style="padding:8px 16px;">ğŸ§¾ PDF ë‹¤ìš´ë¡œë“œ</button>
<button onclick="emailContract()" style="padding:8px 16px;">ğŸ“¬ ì´ë©”ì¼ ì „ì†¡</button>
<div id="emailStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
function downloadContractPDF() {
  const content = document.getElementById("contractResult").innerText;
  if (!content) return alert("ë¨¼ì € ê³„ì•½ì„œë¥¼ ìƒì„±í•´ ì£¼ì„¸ìš”.");
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const lines = content.split('\n');
  lines.forEach((line, i) => doc.text(line, 10, 10 + i * 10));
  doc.save("AgriNexus_Contract.pdf");
}

function emailContract() {
  const content = document.getElementById("contractResult").innerText;
  if (!content) return alert("ë¨¼ì € ê³„ì•½ì„œë¥¼ ìƒì„±í•´ ì£¼ì„¸ìš”.");

  // Simulated email function (replace with real backend or email API)
  document.getElementById("emailStatus").innerText = "ğŸ“§ ì´ë©”ì¼ ì „ì†¡ ì¤‘...";
  setTimeout(() => {
    document.getElementById("emailStatus").innerText = "âœ… ì´ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! (ì‹œë®¬ë ˆì´ì…˜)";
  }, 1500);
}
</script>


<hr style="margin:40px 0;">
<h2>âœˆï¸ğŸš¢ğŸ“¦ ì „ì„¸ê³„ í•­ê³µ/ì„ ë°•/ì¹´ê³ /íƒë°° ì‹¤ì‹œê°„ ë°°ì†¡ ì •ë³´ ì‹œìŠ¤í…œ</h2>
<p>êµ­ê°€ì™€ ìš´ì†¡ ìœ í˜•ì„ ì„ íƒí•˜ë©´ ì‹¤ì‹œê°„ ë°°ì†¡ ë° ë¬¼ë¥˜ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>

<select id="logisticsCountry" style="padding:8px;">
  <option value="United States">ğŸ‡ºğŸ‡¸ ë¯¸êµ­</option>
  <option value="Korea">ğŸ‡°ğŸ‡· í•œêµ­</option>
  <option value="Japan">ğŸ‡¯ğŸ‡µ ì¼ë³¸</option>
  <option value="Germany">ğŸ‡©ğŸ‡ª ë…ì¼</option>
  <option value="China">ğŸ‡¨ğŸ‡³ ì¤‘êµ­</option>
</select>

<select id="logisticsType" style="padding:8px;">
  <option value="air">âœˆï¸ í•­ê³µ</option>
  <option value="sea">ğŸš¢ ì„ ë°•</option>
  <option value="cargo">ğŸ“¦ ì¹´ê³ </option>
  <option value="courier">ğŸ“® íƒë°°</option>
</select>

<button onclick="fetchLogisticsInfo()" style="padding:8px 16px;">ğŸ” ë°°ì†¡ ì •ë³´ ì¡°íšŒ</button>
<div id="logisticsResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function fetchLogisticsInfo() {
  const country = document.getElementById("logisticsCountry").value;
  const type = document.getElementById("logisticsType").value;
  document.getElementById("logisticsResult").innerText = "ğŸšš ë¬¼ë¥˜ ì •ë³´ ë¡œë”© ì¤‘...";

  const prompt = `
"${country}" êµ­ê°€ì˜ "${type}" ìš´ì†¡ ë°©ì‹ì— ëŒ€í•´ ë‹¤ìŒ ì •ë³´ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì œê³µí•´ ì£¼ì„¸ìš”:

1. ìµœê·¼ ì¶œë°œ ë° ë„ì°© ì •ë³´ (ì˜ˆì‹œ ê¸°ë°˜)
2. ì˜ˆìƒ ë°°ì†¡ ì†Œìš” ì‹œê°„
3. ì£¼ìš” í—ˆë¸Œ ë° í•­ë§Œ/ê³µí•­
4. íŠ¹ì´ì‚¬í•­ ë˜ëŠ” ì§€ì—° ìš”ì†Œ
5. ë¬¼ë¥˜ ìš´ì˜ ì—…ì²´ ì˜ˆì‹œ (DHL, FedEx, Maersk ë“±)

ê° í•­ëª©ì€ ëª…í™•í•˜ê³  ê°„ê²°í•˜ê²Œ ìš”ì•½í•´ ì£¼ì„¸ìš”.
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("logisticsResult").innerText = data.choices[0].message.content;
  } catch (e) {
    document.getElementById("logisticsResult").innerText = "âŒ ì‹¤ì‹œê°„ ë¬¼ë¥˜ ì¡°íšŒ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ’° ì‹¤ì‹œê°„ ìš´ì†¡ë¹„ ë¹„êµ ë¶„ì„ + ìµœì  ì„ íƒ ì¶”ì²œ ì‹œìŠ¤í…œ</h2>
<p>êµ­ê°€ ë° ìš´ì†¡ ìœ í˜•, ì˜ˆìƒ ë¬´ê²Œ/ë¶€í”¼ ì…ë ¥ ì‹œ ìµœì ì˜ ë¬¼ë¥˜ ì„ íƒì„ ìë™ ì¶”ì²œí•©ë‹ˆë‹¤.</p>

<select id="costCountry" style="padding:8px;">
  <option value="United States">ğŸ‡ºğŸ‡¸ ë¯¸êµ­</option>
  <option value="Korea">ğŸ‡°ğŸ‡· í•œêµ­</option>
  <option value="Japan">ğŸ‡¯ğŸ‡µ ì¼ë³¸</option>
  <option value="Germany">ğŸ‡©ğŸ‡ª ë…ì¼</option>
  <option value="China">ğŸ‡¨ğŸ‡³ ì¤‘êµ­</option>
</select>

<select id="costType" style="padding:8px;">
  <option value="air">âœˆï¸ í•­ê³µ</option>
  <option value="sea">ğŸš¢ ì„ ë°•</option>
  <option value="cargo">ğŸ“¦ ì¹´ê³ </option>
  <option value="courier">ğŸ“® íƒë°°</option>
</select>

<input type="text" id="costWeight" placeholder="ì˜ˆìƒ ë¬´ê²Œ (kg)" style="padding:8px;width:140px;" />
<input type="text" id="costVolume" placeholder="ì˜ˆìƒ ë¶€í”¼ (CBM)" style="padding:8px;width:140px;" />

<button onclick="fetchLogisticsCost()" style="padding:8px 16px;">ğŸ“Š ë¹„ìš© ë¶„ì„</button>

<div id="logisticsCostResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function fetchLogisticsCost() {
  const country = document.getElementById("costCountry").value;
  const type = document.getElementById("costType").value;
  const weight = document.getElementById("costWeight").value.trim();
  const volume = document.getElementById("costVolume").value.trim();

  if (!weight || !volume) return alert("ë¬´ê²Œì™€ ë¶€í”¼ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("logisticsCostResult").innerText = "ğŸ’¸ ë¹„ìš© ë¶„ì„ ì¤‘...";

  const prompt = `
"${country}"ë¡œ "${type}" ë°©ì‹ì˜ ìš´ì†¡ì„ ì§„í–‰í•  ë•Œ, ë¬´ê²Œ ${weight}kg, ë¶€í”¼ ${volume}CBM ê¸°ì¤€ìœ¼ë¡œ 
ë‹¤ìŒ í•­ëª©ì„ ë¹„êµ ë¶„ì„í•´ ì£¼ì„¸ìš”:

1. ì¶”ì²œ ìš´ì†¡ì‚¬ë³„ ê°€ê²© ì˜ˆì‹œ (DHL, FedEx, Maersk, ìš°ì²´êµ­ ë“±)
2. í•­ê³µ vs ì„ ë°• vs ì¹´ê³  vs íƒë°° ìš”ê¸ˆ ë¹„êµ
3. ë°°ì†¡ ì‹œê°„ ë° ë³´í—˜ í¬í•¨ ì—¬ë¶€
4. ì¶”ì²œ ìµœì  ìš´ì†¡ ë°©ì‹ ë° ì´ìœ 
5. ì´ìš©ìì—ê²Œ ê°€ì¥ íš¨ìœ¨ì ì¸ ì„ íƒ ì•ˆë‚´

ìµœì¢… ì„ íƒ ê°€ì´ë“œë¥¼ ë§ˆì§€ë§‰ì— ìš”ì•½í•´ ì£¼ì„¸ìš”.
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("logisticsCostResult").innerText = data.choices[0].message.content;
  } catch (e) {
    console.error(e);
    document.getElementById("logisticsCostResult").innerText = "âŒ ìš´ì†¡ë¹„ ë¶„ì„ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸšš ê³ ê¸‰ í™”ë¬¼ ì¡°ê±´ ê¸°ë°˜ ë¬¼ë¥˜ë¹„ ìµœì  ë¶„ì„ ì‹œìŠ¤í…œ</h2>
<p>í™”ë¬¼ì˜ ì¬ì§ˆ, ì„±ê²©, ë¬´ê²Œ, ë¶€í”¼, ìœ í†µ ì¡°ê±´ì— ë”°ë¼ ìµœì ì˜ ë¬¼ë¥˜ ì„ íƒì„ ìë™ ë¶„ì„í•©ë‹ˆë‹¤.</p>

<select id="cargoMaterial" style="padding:8px;">
  <option value="steel">ê°•ì² </option>
  <option value="plastic">í”Œë¼ìŠ¤í‹±</option>
  <option value="wood">ëª©ì¬</option>
  <option value="liquid">ì•¡ì²´</option>
  <option value="perishable">ì‹ ì„ /ë¶€íŒ¨ì„±</option>
</select>

<select id="cargoNature" style="padding:8px;">
  <option value="hazardous">ìœ„í—˜ë¬¼</option>
  <option value="fragile">ê¹¨ì§€ê¸° ì‰¬ì›€</option>
  <option value="general">ì¼ë°˜í’ˆ</option>
  <option value="refrigerated">ëƒ‰ì¥/ëƒ‰ë™</option>
</select>

<input type="text" id="cargoWeight" placeholder="ë¬´ê²Œ (kg)" style="padding:8px;width:140px;" />
<input type="text" id="cargoVolume" placeholder="ë¶€í”¼ (CBM)" style="padding:8px;width:140px;" />
<input type="text" id="cargoDuration" placeholder="í¬ë§ ìš´ì†¡ê¸°ê°„ (ì¼)" style="padding:8px;width:180px;" />

<button onclick="analyzeAdvancedLogistics()" style="padding:8px 16px;">ğŸ” ê³ ê¸‰ ë¶„ì„ ì‹¤í–‰</button>

<div id="advancedLogisticsResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function analyzeAdvancedLogistics() {
  const material = document.getElementById("cargoMaterial").value;
  const nature = document.getElementById("cargoNature").value;
  const weight = document.getElementById("cargoWeight").value.trim();
  const volume = document.getElementById("cargoVolume").value.trim();
  const duration = document.getElementById("cargoDuration").value.trim();

  if (!weight || !volume || !duration) return alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("advancedLogisticsResult").innerText = "ğŸš› ê³ ê¸‰ ë¬¼ë¥˜ ë¶„ì„ ì¤‘...";

  const prompt = `
í™”ë¬¼ ì •ë³´:
- ì¬ì§ˆ: ${material}
- ì„±ê²©: ${nature}
- ë¬´ê²Œ: ${weight}kg
- ë¶€í”¼: ${volume}CBM
- í¬ë§ ìš´ì†¡ ê¸°ê°„: ${duration}ì¼

ìœ„ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìµœì ì˜ ë¬¼ë¥˜ ìš´ì†¡ ë°©ë²•(í•­ê³µ, ì„ ë°•, ì¹´ê³ , ì»¨í…Œì´ë„ˆ ë“±)ì„ ì„ íƒí•˜ê³ ,
1. ì˜ˆìƒ ìš´ì†¡ë¹„
2. ì¶”ì²œ ìš´ì†¡ì‚¬
3. ìœ í†µ ì¡°ê±´
4. ì¥ë‹¨ì 
5. ìœ„í—˜ ìš”ì†Œ
6. ìµœì¢… ì¶”ì²œ ì˜µì…˜

ì„ ì‹¤ì‹œê°„ ë¶„ì„í•˜ì—¬ ì•ˆë‚´í•´ ì£¼ì„¸ìš”.
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("advancedLogisticsResult").innerText = data.choices[0].message.content;
  } catch (e) {
    document.getElementById("advancedLogisticsResult").innerText = "âŒ ë¶„ì„ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“„ ì‹¤ ê²¬ì ì„œ ìë™ ìƒì„± ë° ì „ì†¡ ì‹œìŠ¤í…œ</h2>
<p>ìë™ ë¶„ì„ëœ ë¬¼ë¥˜ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê²¬ì ì„œë¥¼ PDFë¡œ ìƒì„±í•˜ê³  ì´ë©”ì¼ ì „ì†¡í•©ë‹ˆë‹¤.</p>
<input type="email" id="estimateEmail" placeholder="ë°›ëŠ” ì´ë©”ì¼ ì£¼ì†Œ" style="padding:8px;width:300px;" />
<button onclick="generateEstimatePDF()" style="padding:8px 16px;">ğŸ§¾ ê²¬ì ì„œ PDF ìƒì„±</button>
<button onclick="sendEstimateEmail()" style="padding:8px 16px;">ğŸ“¬ ê²¬ì ì„œ ì´ë©”ì¼ ì „ì†¡</button>
<div id="estimateStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
function generateEstimatePDF() {
  const content = document.getElementById("advancedLogisticsResult").innerText;
  if (!content) return alert("ë¨¼ì € ë¶„ì„ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.");
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const lines = content.split('\n');
  lines.forEach((line, i) => doc.text(line, 10, 10 + i * 10));
  doc.save("AgriNexus_Estimate.pdf");
  document.getElementById("estimateStatus").innerText = "âœ… PDF ìƒì„± ì™„ë£Œ!";
}

function sendEstimateEmail() {
  const email = document.getElementById("estimateEmail").value.trim();
  if (!email) return alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("estimateStatus").innerText = "ğŸ“¬ ì´ë©”ì¼ ì „ì†¡ ì¤‘... (ì‹œë®¬ë ˆì´ì…˜)";
  setTimeout(() => {
    document.getElementById("estimateStatus").innerText = "âœ… ì´ë©”ì¼ ì „ì†¡ ì™„ë£Œ! (ì‹œë®¬ë ˆì´ì…˜)";
  }, 1500);
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“¦ ì»¨í…Œì´ë„ˆ ë‹¨ê°€ ìë™ ë¹„êµ</h2>
<p>ì¼ë°˜/ëƒ‰ì¥/20ft/40ft ì»¨í…Œì´ë„ˆ ìš´ì†¡ ë¹„ìš© ë¹„êµ ë¶„ì„</p>
<button onclick="compareContainerRates()" style="padding:8px 16px;">ğŸ“Š ë‹¨ê°€ ë¹„êµ ì‹¤í–‰</button>
<div id="containerRateResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function compareContainerRates() {
  document.getElementById("containerRateResult").innerText = "ğŸ“¦ ì»¨í…Œì´ë„ˆ ë‹¨ê°€ ë¶„ì„ ì¤‘...";
  const prompt = `
20ft, 40ft, ëƒ‰ì¥, íŠ¹ìˆ˜ ì»¨í…Œì´ë„ˆ ìš´ì†¡ ì‹œ í‰ê·  ë‹¨ê°€ ë¹„êµ ë¶„ì„ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ ì£¼ì„¸ìš”.
- í•­ê³µ vs í•´ìƒ ë¹„êµ í¬í•¨
- ìˆ˜ì¶œì… êµ­ê°€ì— ë”°ë¼ ê°€ê²© ì°¨ì´ ì˜ˆì‹œë„ í¬í•¨
- ì í•©í•œ ìš©ë„ì™€ ìƒí™©ë³„ ì¶”ì²œë„ ì œì‹œ
  `;
  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });
  const data = await res.json();
  document.getElementById("containerRateResult").innerText = data.choices[0].message.content;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ›¡ï¸ ë³´í—˜ ì¡°ê±´ ìë™ ì œì•ˆ</h2>
<button onclick="suggestInsuranceTerms()" style="padding:8px 16px;">ğŸ§¾ ë³´í—˜ ë¶„ì„ ì‹¤í–‰</button>
<div id="insuranceSuggestion" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function suggestInsuranceTerms() {
  document.getElementById("insuranceSuggestion").innerText = "ğŸ›¡ï¸ ë³´í—˜ ì¡°ê±´ ë¶„ì„ ì¤‘...";
  const prompt = `
êµ­ì œë¬¼ë¥˜ì— í•„ìš”í•œ ë³´í—˜ í•­ëª©ì„ ë¶„ì„í•˜ê³ , ì¼ë°˜í™”ë¬¼, ê³ ê°€í’ˆ, ëƒ‰ë™í’ˆ, ìœ„í—˜ë¬¼ ë“± ì¡°ê±´ë³„ ì ì ˆí•œ ë³´í—˜ ë²”ìœ„ì™€
ì¶”ì²œ ë³´í—˜ì‚¬ë¥¼ ì œì•ˆí•´ ì£¼ì„¸ìš”.
  `;
  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });
  const data = await res.json();
  document.getElementById("insuranceSuggestion").innerText = data.choices[0].message.content;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸŒ êµ­ê°€ë³„ ë¬¼ë¥˜ ì´ìŠˆ ì‹¤ì‹œê°„ ë°˜ì˜</h2>
<button onclick="fetchLogisticsIssues()" style="padding:8px 16px;">ğŸŒ ì´ìŠˆ ì¡°íšŒ</button>
<div id="logisticsIssues" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function fetchLogisticsIssues() {
  document.getElementById("logisticsIssues").innerText = "ğŸŒ ì „ì„¸ê³„ ë¬¼ë¥˜ ì´ìŠˆ ì¡°íšŒ ì¤‘...";
  const prompt = `
ì „ì„¸ê³„ ì£¼ìš” êµ­ê°€ì˜ í˜„ì¬ ë¬¼ë¥˜ ì§€ì—°, í•­ë§Œ ì •ì²´, í•­ê³µ ìš´í•­ ì¤‘ë‹¨, í†µê´€ ì´ìŠˆ ë“±ì„ ì •ë¦¬í•´ ì£¼ì„¸ìš”.
íŠ¹íˆ í•œêµ­, ë¯¸êµ­, ìœ ëŸ½, ì¤‘êµ­, ì¼ë³¸ ìœ„ì£¼ë¡œ ìµœì‹  ë¬¸ì œë¥¼ ì •ë¦¬í•´ ì£¼ì„¸ìš”.
  `;
  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });
  const data = await res.json();
  document.getElementById("logisticsIssues").innerText = data.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“¦ 1ì¸ ì‚¬ì—…ì / ì†Œê·œëª¨ ìˆ˜ì¶œì… ì§€ì› ì‹œìŠ¤í…œ</h2>
<p>ë‹¨ 1ê°œì˜ ìƒí’ˆì´ë¼ë„ ì‰½ê²Œ ìˆ˜ì¶œì…í•  ìˆ˜ ìˆë„ë¡ ìë™ ì¶”ì²œ ë° ë¬¼ë¥˜ ìµœì í™” ì•ˆë‚´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>

<input type="text" id="smeProduct" placeholder="ìƒí’ˆëª… (ì˜ˆ: íœ´ëŒ€ìš© ì„ í’ê¸°)" style="padding:8px;width:300px;" />
<input type="text" id="smeQty" placeholder="ìˆ˜ëŸ‰ (ì˜ˆ: 10ê°œ)" style="padding:8px;width:150px;" />
<select id="smeTarget" style="padding:8px;">
  <option value="United States">ğŸ‡ºğŸ‡¸ ë¯¸êµ­</option>
  <option value="Korea">ğŸ‡°ğŸ‡· í•œêµ­</option>
  <option value="Japan">ğŸ‡¯ğŸ‡µ ì¼ë³¸</option>
  <option value="Germany">ğŸ‡©ğŸ‡ª ë…ì¼</option>
  <option value="China">ğŸ‡¨ğŸ‡³ ì¤‘êµ­</option>
</select>

<button onclick="analyzeSMELogistics()" style="padding:8px 16px;">ğŸ” ì†Œê·œëª¨ ë¬¼ë¥˜ ë¶„ì„</button>

<div id="smeLogisticsResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function analyzeSMELogistics() {
  const product = document.getElementById("smeProduct").value.trim();
  const qty = document.getElementById("smeQty").value.trim();
  const country = document.getElementById("smeTarget").value;

  if (!product || !qty) return alert("ìƒí’ˆëª…ê³¼ ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("smeLogisticsResult").innerText = "ğŸ“¦ ì†Œê·œëª¨ ë¬¼ë¥˜ ë¶„ì„ ì¤‘...";

  const prompt = `
"${product}"ë¥¼ ${qty}ê°œ ìˆ˜ì¶œì…í•˜ê³ ì í•˜ëŠ” ê°œì¸ ë˜ëŠ” ì†Œê·œëª¨ ì‚¬ì—…ìê°€ "${country}"ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•  ë•Œ, 
1. ì ì ˆí•œ ìš´ì†¡ ë°©ì‹ (í•­ê³µ, íƒë°°, EMS ë“±)
2. ì˜ˆìƒ ìš´ì†¡ë¹„
3. í¬ì¥/í†µê´€ ì£¼ì˜ì‚¬í•­
4. ìˆ˜ëŸ‰ì´ ì ì€ ê²½ìš° ìœ ë¦¬í•œ ì¡°ê±´
5. ì í•©í•œ ë¬¼ë¥˜ íšŒì‚¬ ì¶”ì²œ
6. ìë™í™”ëœ ì¶”ì²œ ê°€ì´ë“œ

ìœ„ ë‚´ìš©ì„ ìë™ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ì•ˆë‚´í•´ ì£¼ì„¸ìš”.
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("smeLogisticsResult").innerText = data.choices[0].message.content;
  } catch (e) {
    document.getElementById("smeLogisticsResult").innerText = "âŒ ë¶„ì„ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“š ìˆ˜ì¶œì… ë¬¸ì„œ ìš©ì–´ í•´ì„ + ë²•ë¥  í•´ê²° ìë™ ì‹œìŠ¤í…œ</h2>
<p>ìˆ˜ì¶œì… ê³„ì•½ì„œ, í†µê´€ ë¬¸ì„œ ë“±ì—ì„œ ì–´ë ¤ìš´ ë¬¼ë¥˜ ìš©ì–´ì™€ ê°êµ­ ë²•ë¥  ì‚¬ì•ˆì„ ìë™ìœ¼ë¡œ í•´ì„í•˜ê³  í•´ê²° ê°€ì´ë“œë¥¼ ì œì‹œí•©ë‹ˆë‹¤.</p>

<textarea id="documentText" placeholder="ë¬¸ì„œ ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš” (ì˜ˆ: ê³„ì•½ì„œ ì¡°í•­, í†µê´€ ë¬¸ì¥ ë“±)" style="width:100%;height:100px;padding:10px;"></textarea>
<button onclick="explainDocumentTerms()" style="padding:10px 20px;">ğŸ§  ë¬¸ì„œ í•´ì„ ë° í•´ê²°ì•ˆ ìƒì„±</button>

<div id="documentExplainResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function explainDocumentTerms() {
  const doc = document.getElementById("documentText").value.trim();
  if (!doc) return alert("ë¬¸ì„œ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("documentExplainResult").innerText = "ğŸ“˜ ìš©ì–´ í•´ì„ ë° í•´ê²° ë°©ë²• ë¶„ì„ ì¤‘...";

  const prompt = `
ë‹¤ìŒ ë¬¸ì„œ ë˜ëŠ” ê³„ì•½ì„œ ì¡°í•­ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ,
1. ì „ë¬¸ ìš©ì–´ë¥¼ ì•Œê¸° ì‰½ê²Œ í•´ì„í•˜ê³ 
2. í¬í•¨ëœ ìˆ˜ì¶œì… ë²•ë¥ ì  ìš”ì†Œë¥¼ í•œêµ­ê³¼ ì£¼ìš” êµ­ê°€ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•˜ê³ 
3. ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ ë° ë¶„ìŸì„ ì˜ˆë°©í•  ìˆ˜ ìˆëŠ” í•´ê²° ë°©ë²•ì„ ì œì•ˆí•´ ì£¼ì„¸ìš”.
4. ì´ˆë³´ìë„ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì‰¬ìš´ í‘œí˜„ìœ¼ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”.

ë¬¸ì„œ ë‚´ìš©:
${doc}
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    document.getElementById("documentExplainResult").innerText = data.choices[0].message.content;
  } catch (e) {
    document.getElementById("documentExplainResult").innerText = "âŒ í•´ì„ ì‹¤íŒ¨";
  }
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“„ ë¬¸ì„œ ìë™ ìš”ì•½ ë° PDF ë³´ê³ ì„œ ìƒì„±</h2>
<button onclick="summarizeAndExportPDF()" style="padding:8px 16px;">ğŸ§¾ ìš”ì•½ + PDF ìƒì„±</button>
<div id="summaryPDFStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function summarizeAndExportPDF() {
  const doc = document.getElementById("documentText").value.trim();
  if (!doc) return alert("ë¬¸ì„œ ë‚´ìš©ì„ ë¨¼ì € ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("summaryPDFStatus").innerText = "ğŸ“„ ìš”ì•½ ë° PDF ìƒì„± ì¤‘...";

  const prompt = `
ë‹¤ìŒ ë¬¸ì„œë¥¼ ìš”ì•½í•˜ê³  í•µì‹¬ ë‚´ìš©ì„ ì •ë¦¬í•˜ì—¬ PDF ë³´ê³ ì„œ í˜•íƒœë¡œ ì •ë¦¬í•´ ì£¼ì„¸ìš”:
${doc}
  `;

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer sk-abc123xyz456def..."
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }]
      })
    });

    const data = await res.json();
    const summary = data.choices[0].message.content;

    const { jsPDF } = window.jspdf;
    const docPDF = new jsPDF();
    const lines = summary.split("\n");
    lines.forEach((line, i) => docPDF.text(line, 10, 10 + i * 10));
    docPDF.save("AgriNexus_Report_Summary.pdf");

    document.getElementById("summaryPDFStatus").innerText = "âœ… PDF ìƒì„± ì™„ë£Œ!";
  } catch (e) {
    console.error(e);
    document.getElementById("summaryPDFStatus").innerText = "âŒ PDF ìƒì„± ì‹¤íŒ¨";
  }
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸŒ êµ­ê°€ë³„ ìˆ˜ì¶œì… ë²•ë ¹ ë³€í™” ì‹¤ì‹œê°„ ê°ì§€</h2>
<button onclick="checkLegalChanges()" style="padding:8px 16px;">ğŸ§  ìµœì‹  ë²•ë ¹ ë¶„ì„</button>
<div id="legalChangeResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function checkLegalChanges() {
  document.getElementById("legalChangeResult").innerText = "ğŸ” ìµœì‹  ë²•ë¥  ì •ë³´ ë¶„ì„ ì¤‘...";
  const prompt = `
í•œêµ­, ë¯¸êµ­, EU, ì¤‘êµ­, ì¼ë³¸ì˜ ìµœê·¼ ìˆ˜ì¶œì… ë²•ë ¹ ë° í†µê´€ ì œë„ ë³€ê²½ì‚¬í•­ì„ ìš”ì•½ ì •ë¦¬í•´ ì£¼ì„¸ìš”.
íŠ¹íˆ ì¤‘ì†Œê¸°ì—…, ìŠ¤íƒ€íŠ¸ì—…, ì‹ ìƒ ì‚¬ì—…ìì—ê²Œ ì˜í–¥ì´ ìˆëŠ” ë‚´ìš©ì„ ê°•ì¡°í•´ ì£¼ì„¸ìš”.
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
      },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const data = await res.json();
  document.getElementById("legalChangeResult").innerText = data.choices[0].message.content;
}
</script>

<hr style="margin:40px 0;">
<h2>âš–ï¸ ìˆ˜ì¶œì… ë¶„ìŸ ëŒ€ì‘ ì‹œë®¬ë ˆì´í„°</h2>
<textarea id="disputeInput" placeholder="ë¶„ìŸ ìƒí™© ë˜ëŠ” ì¡°í•­ ì…ë ¥ (ì˜ˆ: ìš´ì†¡ ì§€ì—° ê´€ë ¨ ì¡°í•­)" style="width:100%;height:80px;padding:8px;"></textarea>
<button onclick="simulateDisputeResolution()" style="padding:8px 16px;">ğŸ¤– ëŒ€ì‘ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰</button>
<div id="disputeResult" style="margin-top:20px;font-size:0.9rem;"></div>

<script>
async function simulateDisputeResolution() {
  const scenario = document.getElementById("disputeInput").value.trim();
  if (!scenario) return alert("ë¶„ìŸ ìƒí™©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("disputeResult").innerText = "ğŸ§  ë¶„ìŸ í•´ê²° ì‹œë®¬ë ˆì´ì…˜ ì¤‘...";

  const prompt = `
ë‹¤ìŒ ë¶„ìŸ ë˜ëŠ” ê³„ì•½ ì¡°í•­ì— ëŒ€í•´ í˜„ì‹¤ì ì¸ ëŒ€ì‘ ì „ëµì„ ì œì•ˆí•´ ì£¼ì„¸ìš”.
êµ­ì œë¬´ì—­ ë¶„ìŸ ì „ë¬¸ê°€ ì…ì¥ì—ì„œ,
- ê´€ë ¨ ë²•ë ¹
- í”¼í•´ ìµœì†Œí™” ì „ëµ
- ë²•ë¥ ì  ì ˆì°¨
- ì¤‘ì¬/ì†Œì†¡ ì—¬ë¶€
- ì†Œê¸°ì—… ë˜ëŠ” ê°œì¸ì´ ì„ íƒ ê°€ëŠ¥í•œ ìµœì  ëŒ€ì‘ì•ˆì„ í¬í•¨í•´ ì£¼ì„¸ìš”.

ë‚´ìš©:
${scenario}
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
      },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const data = await res.json();
  document.getElementById("disputeResult").innerText = data.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ§  ì‚¬ìš©ì ë§ì¶¤í˜• ëŒ€ì‘ ì‹œìŠ¤í…œ (CRM ì‘ë‹µ ì €ì¥)</h2>
<input type="text" id="crmUser" placeholder="ì‚¬ìš©ì ì´ë©”ì¼ ë˜ëŠ” ì´ë¦„" style="padding:8px;width:300px;" />
<textarea id="crmFeedback" placeholder="ì‚¬ìš©ìì˜ ë¬¸ì˜ ë˜ëŠ” ì‘ë‹µ ë‚´ìš©" style="width:100%;height:80px;padding:8px;"></textarea>
<button onclick="saveCRMResponse()" style="padding:8px 16px;">ğŸ’¾ CRM ì‘ë‹µ ì €ì¥</button>
<div id="crmStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function saveCRMResponse() {
  const user = document.getElementById("crmUser").value.trim();
  const msg = document.getElementById("crmFeedback").value.trim();
  if (!user || !msg) return alert("ì‚¬ìš©ì ì •ë³´ì™€ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  const entry = { user, msg, time: new Date().toISOString() };
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  data.push(entry);
  localStorage.setItem("agrinexus_crm", JSON.stringify(data));
  document.getElementById("crmStatus").innerText = "âœ… CRM ì‘ë‹µ ì €ì¥ ì™„ë£Œ!";
  document.getElementById("crmUser").value = "";
  document.getElementById("crmFeedback").value = "";
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ—‚ï¸ ë¦¬í¬íŠ¸ ìë™ ì¶•ì  + ì›”ê°„ ìš”ì•½</h2>
<button onclick="showMonthlyReport()" style="padding:8px 16px;">ğŸ“† ì›”ê°„ ìš”ì•½ ë³´ê¸°</button>
<div id="monthlyReport" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function showMonthlyReport() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const now = new Date();
  const month = now.getMonth();
  const filtered = data.filter(entry => new Date(entry.time).getMonth() === month);
  const users = [...new Set(filtered.map(e => e.user))];
  const report = `ğŸ“† ${now.getFullYear()}ë…„ ${month + 1}ì›” ê¸°ì¤€ CRM ì‘ë‹µ ìˆ˜: ${filtered.length}\nì‚¬ìš©ì ìˆ˜: ${users.length}\n`;
  document.getElementById("monthlyReport").innerText = report;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“¬ ë³´ê³ ì„œ ìë™ ì´ë©”ì¼ ì „ì†¡ (ì‹œë®¬ë ˆì´ì…˜)</h2>
<input type="email" id="reportEmail" placeholder="ë°›ëŠ” ì´ë©”ì¼ ì£¼ì†Œ" style="padding:8px;width:300px;" />
<button onclick="sendMonthlyReport()" style="padding:8px 16px;">ğŸ“¤ ì´ë©”ì¼ ì „ì†¡</button>
<div id="emailReportStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function sendMonthlyReport() {
  const email = document.getElementById("reportEmail").value.trim();
  if (!email) return alert("ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("emailReportStatus").innerText = "ğŸ“¤ ë³´ê³ ì„œ ì „ì†¡ ì¤‘...";
  setTimeout(() => {
    document.getElementById("emailReportStatus").innerText = `âœ… ${email} ìœ¼ë¡œ ë³´ê³ ì„œ ì „ì†¡ ì™„ë£Œ! (ì‹œë®¬ë ˆì´ì…˜)`;
  }, 1500);
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“Š ì‚¬ìš©ì ì‘ë‹µ í†µê³„ ëŒ€ì‹œë³´ë“œ</h2>
<button onclick="renderCRMChart()" style="padding:8px 16px;">ğŸ“ˆ í†µê³„ ì°¨íŠ¸ ë³´ê¸°</button>
<canvas id="crmChart" width="400" height="200" style="margin-top:20px;"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
function renderCRMChart() {
  const rawData = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const dateMap = {};
  rawData.forEach(entry => {
    const d = new Date(entry.time);
    const label = `${d.getFullYear()}-${(d.getMonth()+1).toString().padStart(2,'0')}`;
    dateMap[label] = (dateMap[label] || 0) + 1;
  });

  const labels = Object.keys(dateMap).sort();
  const values = labels.map(label => dateMap[label]);

  const ctx = document.getElementById('crmChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        label: 'ì›”ë³„ CRM ì‘ë‹µ ìˆ˜',
        data: values,
        backgroundColor: '#4CAF50'
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“ í†µê³„ ì°¨íŠ¸ PDF ì €ì¥</h2>
<button onclick="downloadChartAsPDF()" style="padding:8px 16px;">ğŸ§¾ PDFë¡œ ì €ì¥</button>
<div id="chartPDFStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function downloadChartAsPDF() {
  const canvas = document.getElementById("crmChart");
  const imageData = canvas.toDataURL("image/png");
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  pdf.addImage(imageData, 'PNG', 10, 10, 180, 100);
  pdf.save("AgriNexus_CRM_Chart.pdf");
  document.getElementById("chartPDFStatus").innerText = "âœ… PDF ì €ì¥ ì™„ë£Œ";
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ” ì‚¬ìš©ìë³„ CRM ì‘ë‹µ ì—´ëŒ</h2>
<button onclick="showUserResponses()" style="padding:8px 16px;">ğŸ“‹ ì‚¬ìš©ìë³„ ë³´ê¸°</button>
<div id="userResponses" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function showUserResponses() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const map = {};
  data.forEach(e => {
    if (!map[e.user]) map[e.user] = [];
    map[e.user].push(e.msg);
  });
  let output = "";
  Object.keys(map).forEach(user => {
    output += `ğŸ“§ ${user}\n`;
    map[user].forEach(msg => output += ` - ${msg}\n`);
  });
  document.getElementById("userResponses").innerText = output || "âš ï¸ ì €ì¥ëœ ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.";
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“Š ì¼ê°„/ì£¼ê°„/ì›”ê°„ ë¹„êµ ë¶„ì„</h2>
<select id="timeFilter" onchange="filterByTimeRange()" style="padding:6px;">
  <option value="day">ìµœê·¼ 1ì¼</option>
  <option value="week">ìµœê·¼ 7ì¼</option>
  <option value="month">ìµœê·¼ 30ì¼</option>
</select>
<div id="timeRangeStats" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function filterByTimeRange() {
  const range = document.getElementById("timeFilter").value;
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const now = Date.now();
  let cutoff = now;
  if (range === "day") cutoff -= 1 * 24 * 60 * 60 * 1000;
  if (range === "week") cutoff -= 7 * 24 * 60 * 60 * 1000;
  if (range === "month") cutoff -= 30 * 24 * 60 * 60 * 1000;

  const filtered = data.filter(e => new Date(e.time).getTime() > cutoff);
  document.getElementById("timeRangeStats").innerText = `ğŸ“† ${range.toUpperCase()} ê¸°ì¤€ ì‘ë‹µ ìˆ˜: ${filtered.length}`;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“‚ CRM ì‘ë‹µ CSV ë‚´ë³´ë‚´ê¸°</h2>
<button onclick="exportCRMtoCSV()" style="padding:8px 16px;">ğŸ“¤ CSV ë‹¤ìš´ë¡œë“œ</button>
<div id="csvStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function exportCRMtoCSV() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  if (!data.length) return alert("ì €ì¥ëœ ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.");
  const header = "User,Message,Time\n";
  const rows = data.map(d => `"${d.user}","${d.msg}","${d.time}"`).join("\n");
  const blob = new Blob([header + rows], { type: "text/csv;charset=utf-8;" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "agrinexus_crm_responses.csv";
  link.click();
  document.getElementById("csvStatus").innerText = "âœ… CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ";
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“ˆ ì‘ë‹µ ìœ í˜•ë³„ íƒœê·¸ ë° ê°ì„± ë¶„ì„</h2>
<button onclick="analyzeSentiments()" style="padding:8px 16px;">ğŸ” ê°ì„± ë¶„ì„ ì‹¤í–‰</button>
<div id="sentimentResults" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function analyzeSentiments() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const input = data.slice(-10).map(d => `- ${d.msg}`).join("\n");

  if (!input) return alert("ë¶„ì„í•  ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.");

  document.getElementById("sentimentResults").innerText = "ğŸ§  ê°ì„± ë° íƒœê·¸ ë¶„ì„ ì¤‘...";

  const prompt = `
ë‹¤ìŒ ê³ ê° ì‘ë‹µ ë©”ì‹œì§€ 10ê°œë¥¼ ë¶„ì„í•˜ì—¬ ì•„ë˜ ê¸°ì¤€ìœ¼ë¡œ íƒœê¹…í•´ ì£¼ì„¸ìš”:
- ì£¼ìš” í‚¤ì›Œë“œ ì¶”ì¶œ
- ê°ì„± ë¶„ì„ (ê¸ì •/ì¤‘ë¦½/ë¶€ì •)
- ì‘ë‹µ ìœ í˜• (ë¬¸ì˜, ë¶ˆë§Œ, ì¹­ì°¬, ì œì•ˆ ë“±)
í˜•ì‹: ë©”ì‹œì§€ â†’ í‚¤ì›Œë“œ / ê°ì„± / ìœ í˜•

${input}
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const dataOut = await res.json();
  document.getElementById("sentimentResults").innerText = dataOut.choices[0].message.content;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ¤– GPT ê¸°ë°˜ í”¼ë“œë°± ìë™ ì‘ë‹µ ìƒì„±</h2>
<textarea id="autoReplyInput" placeholder="ê³ ê° ì‘ë‹µì„ ì…ë ¥í•´ ì£¼ì„¸ìš”" style="width:100%;height:80px;padding:8px;"></textarea>
<button onclick="generateAutoReply()" style="padding:8px 16px;">âœ‰ï¸ ìë™ ì‘ë‹µ ìƒì„±</button>
<div id="autoReplyResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function generateAutoReply() {
  const input = document.getElementById("autoReplyInput").value.trim();
  if (!input) return alert("ì…ë ¥ ë‚´ìš©ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”.");
  document.getElementById("autoReplyResult").innerText = "ğŸ“© ìë™ ì‘ë‹µ ìƒì„± ì¤‘...";

  const prompt = `
ë‹¤ìŒ ê³ ê° ë©”ì‹œì§€ì— ëŒ€í•´ ê°ì‚¬ì˜ ë§ê³¼ í•¨ê»˜ ì •í™•í•˜ê³  ì¹œì ˆí•œ ë‹µë³€ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”. 200ì ì´ë‚´:

"${input}"
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const dataOut = await res.json();
  document.getElementById("autoReplyResult").innerText = dataOut.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“¬ ìë™ ì‘ë‹µ ì´ë©”ì¼ ì „ì†¡ (ì‹œë®¬ë ˆì´ì…˜)</h2>
<input type="email" id="replyEmail" placeholder="ê³ ê° ì´ë©”ì¼" style="padding:8px;width:300px;" />
<button onclick="simulateReplySend()" style="padding:8px 16px;">ğŸ“¤ ìë™ ì‘ë‹µ ë©”ì¼ ì „ì†¡</button>
<div id="emailReplyStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function simulateReplySend() {
  const email = document.getElementById("replyEmail").value.trim();
  if (!email) return alert("ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("emailReplyStatus").innerText = "ğŸ“¡ ë©”ì¼ ì „ì†¡ ì¤‘...";
  setTimeout(() => {
    document.getElementById("emailReplyStatus").innerText = `âœ… ${email} ìœ¼ë¡œ ì‘ë‹µ ì „ì†¡ ì™„ë£Œ! (ì‹œë®¬ë ˆì´ì…˜)`;
  }, 1200);
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“ˆ ê°ì„± ë³€í™” ì¶”ì  ì°¨íŠ¸</h2>
<canvas id="sentimentTrendChart" width="400" height="200" style="margin-top:10px;"></canvas>
<button onclick="drawSentimentTrend()" style="padding:8px 16px;">ğŸ“Š ê°ì„± ë³€í™” ë³´ê¸°</button>

<script>
function drawSentimentTrend() {
  const rawData = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const sample = rawData.slice(-12).map(d => d.msg);

  const sentimentValues = sample.map(msg => {
    if (msg.includes("ê°ì‚¬") || msg.includes("ì¢‹ì•„ìš”")) return 2;
    if (msg.includes("ë¶ˆí¸") || msg.includes("ëŠ¦ìŒ") || msg.includes("ë¶ˆë§Œ")) return 0;
    return 1;
  });

  const ctx = document.getElementById("sentimentTrendChart").getContext("2d");
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: sentimentValues.map((_, i) => `ì‘ë‹µ${i+1}`),
      datasets: [{
        label: 'ê°ì„± ì¶”ì´ (0:ë¶€ì •, 1:ì¤‘ë¦½, 2:ê¸ì •)',
        data: sentimentValues,
        borderColor: '#2196F3',
        tension: 0.3
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { min: 0, max: 2, ticks: { stepSize: 1 } }
      }
    }
  });
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ” ìœ ì‚¬ í”¼ë“œë°± í´ëŸ¬ìŠ¤í„°ë§ (GPT ê¸°ë°˜)</h2>
<button onclick="clusterSimilarFeedback()" style="padding:8px 16px;">ğŸ§  í´ëŸ¬ìŠ¤í„° ë¶„ì„ ì‹¤í–‰</button>
<div id="feedbackClusters" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function clusterSimilarFeedback() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const messages = data.slice(-12).map(d => `- ${d.msg}`).join("\n");
  if (!messages) return alert("ë¶„ì„í•  ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.");
  document.getElementById("feedbackClusters").innerText = "ğŸ” í´ëŸ¬ìŠ¤í„° ë¶„ì„ ì¤‘...";

  const prompt = `
ë‹¤ìŒ ê³ ê° í”¼ë“œë°±ë“¤ì„ ìœ ì‚¬í•œ ìœ í˜•ë¼ë¦¬ 3~5ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¡œ ë¬¶ì–´ì£¼ì„¸ìš”.
ê° ê·¸ë£¹ì€ ê³µí†µ ì£¼ì œ ë˜ëŠ” ê°ì •ì´ ìˆì–´ì•¼ í•˜ë©°, ëŒ€í‘œ í‚¤ì›Œë“œì™€ í•¨ê»˜ ë¬¶ì–´ì£¼ì„¸ìš”:

${messages}
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const result = await res.json();
  document.getElementById("feedbackClusters").innerText = result.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“¤ SendGrid ì´ë©”ì¼ ì „ì†¡ í†µí•© (ì‹¤ì œ API ì—°ë™ìš©)</h2>
<p>ì‹¤ì œ SendGrid ì—°ë™ì„ ìœ„í•´ API í‚¤ë¥¼ ì„¤ì •í•˜ê³  ì•„ë˜ ì½”ë“œë¥¼ ë°±ì—”ë“œì— ì—°ë™í•´ ì£¼ì„¸ìš”:</p>
<pre style="background:#f0f0f0;padding:10px;font-size:0.8rem;overflow-x:auto;">
POST https://api.sendgrid.com/v3/mail/send
Headers:
  Authorization: Bearer YOUR_API_KEY
  Content-Type: application/json

Body:
{
  "personalizations": [{ "to": [{ "email": "client@example.com" }] }],
  "from": { "email": "noreply@agrinexus.world" },
  "subject": "AgriNexus ìë™ ì‘ë‹µ",
  "content": [{ "type": "text/plain", "value": "ìë™ ì‘ë‹µ ë‚´ìš©ì…ë‹ˆë‹¤." }]
}
</pre>

---

<h2>ğŸ” ìë™ ì‘ë‹µ ìƒì„± + ì´ë©”ì¼ ì „ì†¡ í†µí•© ì›Œí¬í”Œë¡œìš°</h2>
<textarea id="workflowInput" placeholder="ê³ ê° í”¼ë“œë°± ì…ë ¥" style="width:100%;height:80px;padding:8px;"></textarea>
<input type="email" id="workflowEmail" placeholder="ë°›ëŠ” ì´ë©”ì¼ ì£¼ì†Œ" style="padding:8px;width:300px;" />
<button onclick="runAutoReplyWorkflow()" style="padding:8px 16px;">ğŸ¤– ìë™ ì‘ë‹µ + ë©”ì¼ ì „ì†¡</button>
<div id="workflowResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function runAutoReplyWorkflow() {
  const feedback = document.getElementById("workflowInput").value.trim();
  const email = document.getElementById("workflowEmail").value.trim();
  if (!feedback || !email) return alert("í”¼ë“œë°±ê³¼ ì´ë©”ì¼ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("workflowResult").innerText = "ğŸ§  ì‘ë‹µ ìƒì„± ì¤‘...";

  const prompt = `
ë‹¤ìŒ ê³ ê° ë©”ì‹œì§€ì— ëŒ€í•´ 200ì ì´ë‚´ë¡œ ì •í™•í•˜ê³  ì¹œì ˆí•œ ìë™ ì‘ë‹µì„ ìƒì„±í•˜ì„¸ìš”:
"${feedback}"
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const data = await res.json();
  const reply = data.choices[0].message.content;

  // Simulated email send
  document.getElementById("workflowResult").innerText = `âœ… ìë™ ì‘ë‹µ ìƒì„± ì™„ë£Œ:\n${reply}\nğŸ“¬ ì´ë©”ì¼ ì „ì†¡ ì¤‘ (ì‹œë®¬ë ˆì´ì…˜)...`;
  setTimeout(() => {
    document.getElementById("workflowResult").innerText += `\nâœ… ${email} ìœ¼ë¡œ ì „ì†¡ ì™„ë£Œ!`;
  }, 1500);
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ§  í´ëŸ¬ìŠ¤í„°ë³„ ëŒ€ì‘ ê°€ì´ë“œ ìë™ ìƒì„±</h2>
<button onclick="generateResponseGuides()" style="padding:8px 16px;">ğŸ“š ê°€ì´ë“œ ìƒì„±</button>
<div id="clusterGuideResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function generateResponseGuides() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const messages = data.slice(-12).map(d => `- ${d.msg}`).join("\n");
  if (!messages) return alert("ë¶„ì„í•  ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.");

  document.getElementById("clusterGuideResult").innerText = "ğŸ“– ê°€ì´ë“œ ìƒì„± ì¤‘...";

  const prompt = `
ë‹¤ìŒ ê³ ê° í”¼ë“œë°±ë“¤ì„ 3~5ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¡œ ë‚˜ëˆˆ ë’¤, ê° í´ëŸ¬ìŠ¤í„°ë³„ë¡œ ì¶”ì²œ ëŒ€ì‘ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•´ ì£¼ì„¸ìš”.
- í´ëŸ¬ìŠ¤í„° ì´ë¦„
- ëŒ€í‘œ í‚¤ì›Œë“œ
- ì¶”ì²œ ì‘ë‹µ í…œí”Œë¦¿ (150ì ì´ë‚´)

${messages}
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const result = await res.json();
  document.getElementById("clusterGuideResult").innerText = result.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ§¾ ìë™ ì‘ë‹µ í…œí”Œë¦¿ ì €ì¥ ë° ì¬ì‚¬ìš©</h2>
<textarea id="templateInput" placeholder="ì‘ë‹µ í…œí”Œë¦¿ ì‘ì„±" style="width:100%;height:60px;padding:8px;"></textarea>
<button onclick="saveReplyTemplate()" style="padding:8px 16px;">ğŸ’¾ í…œí”Œë¦¿ ì €ì¥</button>
<button onclick="loadReplyTemplate()" style="padding:8px 16px;">ğŸ“‚ í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°</button>
<div id="templateStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function saveReplyTemplate() {
  const content = document.getElementById("templateInput").value.trim();
  if (!content) return alert("ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  localStorage.setItem("agrinexus_reply_template", content);
  document.getElementById("templateStatus").innerText = "âœ… í…œí”Œë¦¿ ì €ì¥ ì™„ë£Œ";
}
function loadReplyTemplate() {
  const saved = localStorage.getItem("agrinexus_reply_template");
  if (saved) {
    document.getElementById("templateInput").value = saved;
    document.getElementById("templateStatus").innerText = "ğŸ“‚ í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ";
  } else {
    document.getElementById("templateStatus").innerText = "âš ï¸ ì €ì¥ëœ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤.";
  }
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ’¬ ìë™ ì‘ë‹µ SMS ì „ì†¡ (ì‹œë®¬ë ˆì´ì…˜)</h2>
<input type="text" id="smsNumber" placeholder="ìˆ˜ì‹ ì íœ´ëŒ€í° ë²ˆí˜¸" style="padding:8px;width:250px;" />
<button onclick="sendSMSSimulation()" style="padding:8px 16px;">ğŸ“² SMS ì „ì†¡</button>
<div id="smsStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function sendSMSSimulation() {
  const number = document.getElementById("smsNumber").value.trim();
  if (!number) return alert("ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("smsStatus").innerText = "ğŸ“¡ SMS ì „ì†¡ ì¤‘...";
  setTimeout(() => {
    document.getElementById("smsStatus").innerText = `âœ… ${number} ë¡œ SMS ì „ì†¡ ì™„ë£Œ! (ì‹œë®¬ë ˆì´ì…˜)`;
  }, 1200);
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ§© GPT ê¸°ë°˜ ìë™ í•™ìŠµ ì‘ë‹µ ìƒì„±</h2>
<button onclick="generateAutoLearningReplies()" style="padding:8px 16px;">ğŸ§  í•™ìŠµí˜• ì‘ë‹µ ìƒì„±</button>
<div id="aiLearningResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function generateAutoLearningReplies() {
  const data = JSON.parse(localStorage.getItem("agrinexus_crm") || "[]");
  const grouped = data.slice(-10).map(e => `ê³ ê°: ${e.msg}`).join("\n");
  if (!grouped) return alert("í•™ìŠµí•  í”¼ë“œë°±ì´ ì—†ìŠµë‹ˆë‹¤.");

  document.getElementById("aiLearningResult").innerText = "ğŸ§  GPT ê¸°ë°˜ í•™ìŠµ ì‘ë‹µ ìƒì„± ì¤‘...";

  const prompt = `
ë‹¤ìŒ ê³ ê° í”¼ë“œë°± ë°ì´í„°ë¥¼ ì°¸ê³ í•˜ì—¬,
ë°˜ë³µì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” íŒ¨í„´ì´ë‚˜ ìœ í˜•ì— ë”°ë¼ AI ìë™í™” ì‘ë‹µ í…œí”Œë¦¿ì„ ìƒì„±í•´ ì£¼ì„¸ìš”.
ê° ì‘ë‹µ ìœ í˜•ë³„ë¡œ 1~2ì¤„ ë¶„ëŸ‰ì˜ í…œí”Œë¦¿ìœ¼ë¡œ ì •ë¦¬í•´ ì£¼ì„¸ìš”:

${grouped}
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const result = await res.json();
  document.getElementById("aiLearningResult").innerText = result.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“¬ Twilio SMS API ì—°ë™ ì˜ˆì‹œ</h2>
<p>ì‹¤ì œ ë¬¸ì ì „ì†¡ API êµ¬ì„± (Node.js ì„œë²„ í•„ìš”)</p>
<pre style="background:#f4f4f4;padding:10px;font-size:0.8rem;">
const twilio = require('twilio');
const client = new twilio('ACCOUNT_SID', 'AUTH_TOKEN');

client.messages.create({
  body: 'AgriNexus ìë™ ì‘ë‹µì…ë‹ˆë‹¤.',
  to: '+821012345678',
  from: '+12015551234'
}).then(msg => console.log(msg.sid));
</pre>

---

<h2>ğŸ§¾ GPT ê¸°ë°˜ í…œí”Œë¦¿ ìë™ ë¶„ë¥˜ ë° ì¶”ì²œ</h2>
<button onclick="analyzeTemplateCategories()" style="padding:8px 16px;">ğŸ“š í…œí”Œë¦¿ ë¶„ë¥˜ ë° ì¶”ì²œ</button>
<div id="templateCategoryOutput" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function analyzeTemplateCategories() {
  const stored = localStorage.getItem("agrinexus_reply_template") || "";
  if (!stored) return alert("ì €ì¥ëœ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤.");
  document.getElementById("templateCategoryOutput").innerText = "ğŸ§  í…œí”Œë¦¿ ë¶„ì„ ì¤‘...";

  const prompt = `
ë‹¤ìŒ í…œí”Œë¦¿ ë©”ì‹œì§€ë¥¼ ì ì ˆí•œ ì¹´í…Œê³ ë¦¬(ë¬¸ì˜/ë¶ˆë§Œ/ì¹­ì°¬/ì œì•ˆ ë“±)ë¡œ ë¶„ë¥˜í•˜ê³ , ìœ ì‚¬í•œ ì¶”ì²œ í…œí”Œë¦¿ì„ 1~2ê°œ ì œì•ˆí•´ ì£¼ì„¸ìš”:

"${stored}"
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const result = await res.json();
  document.getElementById("templateCategoryOutput").innerText = result.choices[0].message.content;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“… ì˜ˆì•½ ë¬¸ì ì „ì†¡ ì‹œë®¬ë ˆì´ì…˜</h2>
<input type="text" id="scheduledMsg" placeholder="ì „ì†¡í•  ë©”ì‹œì§€" style="padding:8px;width:80%;" />
<input type="number" id="delaySeconds" placeholder="ëª‡ ì´ˆ í›„ ì „ì†¡?" style="padding:8px;width:180px;" />
<button onclick="scheduleSMS()" style="padding:8px 16px;">â° ì˜ˆì•½ ì „ì†¡ ì‹¤í–‰</button>
<div id="scheduledSMSResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function scheduleSMS() {
  const msg = document.getElementById("scheduledMsg").value.trim();
  const delay = parseInt(document.getElementById("delaySeconds").value.trim(), 10) * 1000;
  if (!msg || isNaN(delay)) return alert("ë©”ì‹œì§€ì™€ ì „ì†¡ì‹œê°„ì„ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("scheduledSMSResult").innerText = `â³ ${delay / 1000}ì´ˆ í›„ ë©”ì‹œì§€ ì „ì†¡ ì˜ˆì •...`;

  setTimeout(() => {
    document.getElementById("scheduledSMSResult").innerText = `âœ… ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ: "${msg}" (ì‹œë®¬ë ˆì´ì…˜)`;
  }, delay);
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“Š í…œí”Œë¦¿ ì‚¬ìš© í†µê³„ ë¶„ì„</h2>
<button onclick="recordTemplateUse()" style="padding:8px 16px;">ğŸ“ˆ ì‚¬ìš© ê¸°ë¡ ì¶”ê°€</button>
<canvas id="templateUsageChart" width="400" height="200" style="margin-top:20px;"></canvas>

<script>
function recordTemplateUse() {
  const content = localStorage.getItem("agrinexus_reply_template") || "ê¸°ë³¸í…œí”Œë¦¿";
  const map = JSON.parse(localStorage.getItem("template_usage") || "{}");
  map[content] = (map[content] || 0) + 1;
  localStorage.setItem("template_usage", JSON.stringify(map));
  drawTemplateUsageChart();
}

function drawTemplateUsageChart() {
  const map = JSON.parse(localStorage.getItem("template_usage") || "{}");
  const labels = Object.keys(map);
  const data = labels.map(k => map[k]);
  const ctx = document.getElementById("templateUsageChart").getContext("2d");
  new Chart(ctx, {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{ label: "í…œí”Œë¦¿ ì‚¬ìš© íšŸìˆ˜", data: data, backgroundColor: "#3f51b5" }]
    },
    options: { responsive: true, indexAxis: "y" }
  });
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“ˆ ì˜ˆì•½ ë¬¸ì ë°˜ë³µ ì „ì†¡ ì‹œë®¬ë ˆì´ì…˜</h2>
<input type="text" id="repeatMessage" placeholder="ë³´ë‚¼ ë©”ì‹œì§€" style="padding:8px;width:300px;" />
<input type="number" id="repeatCount" placeholder="ë°˜ë³µ íšŸìˆ˜" style="padding:8px;width:150px;" />
<input type="number" id="repeatDelay" placeholder="ê°„ê²© (ì´ˆ)" style="padding:8px;width:150px;" />
<button onclick="scheduleRepeatingSMS()" style="padding:8px 16px;">ğŸ” ë°˜ë³µ ì „ì†¡ ì‹œì‘</button>
<div id="repeatResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function scheduleRepeatingSMS() {
  const msg = document.getElementById("repeatMessage").value.trim();
  const count = parseInt(document.getElementById("repeatCount").value, 10);
  const delay = parseInt(document.getElementById("repeatDelay").value, 10) * 1000;
  if (!msg || isNaN(count) || isNaN(delay)) return alert("ëª¨ë“  ê°’ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");

  document.getElementById("repeatResult").innerText = `ğŸ” ì´ ${count}íšŒ ì „ì†¡ ì˜ˆì •...`;

  for (let i = 0; i < count; i++) {
    setTimeout(() => {
      const log = document.getElementById("repeatResult").innerText;
      document.getElementById("repeatResult").innerText = `${log}\nâœ… ${i + 1}íšŒ ì „ì†¡ ì™„ë£Œ: "${msg}"`;
    }, delay * (i + 1));
  }
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ§  í…œí”Œë¦¿ íš¨ê³¼ ìë™ ìµœì í™” ê°€ì´ë“œ (GPT)</h2>
<button onclick="suggestTemplateImprovements()" style="padding:8px 16px;">ğŸ“‹ í…œí”Œë¦¿ ê°œì„  ì œì•ˆ ë°›ê¸°</button>
<div id="templateImproveOutput" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function suggestTemplateImprovements() {
  const stored = localStorage.getItem("agrinexus_reply_template") || "";
  if (!stored) return alert("í…œí”Œë¦¿ì„ ë¨¼ì € ì €ì¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("templateImproveOutput").innerText = "ğŸ§  ë¶„ì„ ì¤‘...";

  const prompt = `
ë‹¤ìŒ ìë™ ì‘ë‹µ í…œí”Œë¦¿ì˜ ë¬¸ì¥ì„ ê°œì„ í•´ ì£¼ì„¸ìš”.
- ì „ë‹¬ë ¥, ëª…í™•ì„±, ê³µê°ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ ê°„ê²°í•˜ê³  íš¨ê³¼ì ì¸ ë¬¸ì¥ìœ¼ë¡œ ì œì•ˆí•´ ì£¼ì„¸ìš”.
- 200ì ì´ë‚´ë¡œ êµ¬ì„±í•´ ì£¼ì„¸ìš”.

"${stored}"
  `;

  const res = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk-abc123xyz456def..."
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });

  const result = await res.json();
  document.getElementById("templateImproveOutput").innerText = result.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ—ºï¸ ì‹¤ì‹œê°„ ì‚¬ìš©ì í™œë™ ì§€ë„ ì‹œê°í™” (ì‹œë®¬ë ˆì´ì…˜)</h2>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Equirectangular-projection.jpg/640px-Equirectangular-projection.jpg" 
style="width:100%;max-width:600px;border:2px solid #ddd;" />
<p>ğŸ§­ ì‚¬ìš©ì ì ‘ì† ìœ„ì¹˜ì— ë”°ë¼ ë¶‰ì€ ì›ìœ¼ë¡œ ì‹œê°í™” ê°€ëŠ¥ (í–¥í›„ GeoIP ì—°ë™)</p>

---

<h2>ğŸ¤– AI ì¶”ì²œ ê¸°ë°˜ ê²¬ì  ìë™ ì œì•ˆ</h2>
<input type="text" id="quotePrompt" placeholder="ìƒí’ˆëª… + ìˆ˜ëŸ‰ ë˜ëŠ” ìš”ì²­ ì…ë ¥" style="width:100%;padding:8px;" />
<button onclick="generateSmartQuote()" style="padding:8px 16px;">ğŸ“ˆ AI ê²¬ì  ì œì•ˆ</button>
<div id="quoteSuggestion" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function generateSmartQuote() {
  const prompt = document.getElementById("quotePrompt").value.trim();
  if (!prompt) return alert("ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("quoteSuggestion").innerText = "ğŸ§  ë¶„ì„ ì¤‘...";
  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer sk-abc123xyz456def...",
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: "ë‹¤ìŒ ìš”ì²­ì— ëŒ€í•´ ê²¬ì ì„ ì¶”ì²œí•´ ì£¼ì„¸ìš”:\n" + prompt }]
    })
  });
  const data = await response.json();
  document.getElementById("quoteSuggestion").innerText = data.choices[0].message.content;
}
</script>

---

<h2>ğŸ§­ ê¸€ë¡œë²Œ ìˆ˜ì¶œì… ìš”ê±´ ë¹„êµ ì‹œìŠ¤í…œ</h2>
<input type="text" id="exportCountry1" placeholder="êµ­ê°€ A (ì˜ˆ: Korea)" style="padding:6px;width:200px;" />
<input type="text" id="exportCountry2" placeholder="êµ­ê°€ B (ì˜ˆ: United States)" style="padding:6px;width:200px;" />
<button onclick="compareRequirements()" style="padding:8px 16px;">ğŸŒ ë¹„êµ ì‹¤í–‰</button>
<div id="compareExportResult" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function compareRequirements() {
  const a = document.getElementById("exportCountry1").value.trim();
  const b = document.getElementById("exportCountry2").value.trim();
  if (!a || !b) return alert("ë‘ êµ­ê°€ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("compareExportResult").innerText = "ğŸ“Š ë¹„êµ ë¶„ì„ ì¤‘...";
  const prompt = `êµ­ê°€ ${a}ì™€ ${b}ì˜ ìˆ˜ì¶œì… ìš”ê±´, í†µê´€ ì œë„, í•„ìš”í•œ ë¬¸ì„œë¥¼ ë¹„êµí•´ ì£¼ì„¸ìš”.`;
  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer sk-abc123xyz456def...",
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });
  const data = await response.json();
  document.getElementById("compareExportResult").innerText = data.choices[0].message.content;
}
</script>

---

<h2>ğŸ“‹ ê³„ì•½ì„œ ìë™ ìƒì„± ë§ˆë²•ì‚¬ (ë‹¨ê³„ë³„)</h2>
<div>
  <input id="partyA" placeholder="ë‹¹ì‚¬ì A ì´ë¦„" style="margin:5px;" />
  <input id="partyB" placeholder="ë‹¹ì‚¬ì B ì´ë¦„" style="margin:5px;" />
  <input id="item" placeholder="ê±°ë˜ í’ˆëª©" style="margin:5px;" />
  <input id="amount" placeholder="ìˆ˜ëŸ‰ / ë‹¨ê°€" style="margin:5px;" />
  <input id="terms" placeholder="ì¸ì½”í…€ì¦ˆ ì¡°ê±´ (ì˜ˆ: FOB)" style="margin:5px;" />
  <button onclick="generateContractWizard()" style="margin-top:10px;padding:8px 16px;">ğŸ§¾ ê³„ì•½ì„œ ìƒì„±</button>
</div>
<div id="contractWizardOutput" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function generateContractWizard() {
  const a = document.getElementById("partyA").value;
  const b = document.getElementById("partyB").value;
  const item = document.getElementById("item").value;
  const amt = document.getElementById("amount").value;
  const terms = document.getElementById("terms").value;
  if (!a || !b || !item || !amt || !terms) return alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  document.getElementById("contractWizardOutput").innerText = "ğŸ“‹ ê³„ì•½ì„œ ìƒì„± ì¤‘...";
  const prompt = `ë‹¤ìŒ ì¡°ê±´ìœ¼ë¡œ ê³„ì•½ì„œë¥¼ ì‘ì„±í•´ ì£¼ì„¸ìš”:\n- ë‹¹ì‚¬ì: ${a} vs ${b}\n- í’ˆëª©: ${item}\n- ìˆ˜ëŸ‰/ë‹¨ê°€: ${amt}\n- ì¡°ê±´: ${terms}`;
  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer sk-abc123xyz456def...",
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });
  const data = await response.json();
  document.getElementById("contractWizardOutput").innerText = data.choices[0].message.content;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸŒ ì‹¤ì‹œê°„ GeoIP ì‚¬ìš©ì êµ­ê°€ ìœ„ì¹˜ ì¶”ì  (ì‹œë®¬ë ˆì´ì…˜)</h2>
<button onclick="simulateGeoIP()" style="padding:8px 16px;">ğŸŒ ì‚¬ìš©ì ìœ„ì¹˜ ì¡°íšŒ</button>
<div id="geoIPOutput" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function simulateGeoIP() {
  document.getElementById("geoIPOutput").innerText = "ğŸ“¡ ì‚¬ìš©ì ìœ„ì¹˜ ì¡°íšŒ ì¤‘...";
  try {
    const res = await fetch("https://ipapi.co/json/");
    const data = await res.json();
    const country = data.country_name;
    const ip = data.ip;
    document.getElementById("geoIPOutput").innerText = `ğŸŒ ì ‘ì† ìœ„ì¹˜: ${country} (${ip})`;
  } catch {
    document.getElementById("geoIPOutput").innerText = "âŒ ìœ„ì¹˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
  }
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“¤ ê²¬ì /ê³„ì•½ì„œ PDF ì €ì¥ ë° ì´ë©”ì¼ ì „ì†¡ (ì‹œë®¬ë ˆì´ì…˜)</h2>
<textarea id="quoteOrContractText" placeholder="ì €ì¥í•  ë‚´ìš© ì…ë ¥" style="width:100%;height:80px;"></textarea>
<input type="email" id="emailTarget" placeholder="ë°›ëŠ” ì´ë©”ì¼ ì£¼ì†Œ" style="padding:8px;width:300px;" />
<button onclick="saveAndSendDoc()" style="padding:8px 16px;">ğŸ“ PDF ì €ì¥ + ë©”ì¼ ë°œì†¡</button>
<div id="emailSendStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function saveAndSendDoc() {
  const content = document.getElementById("quoteOrContractText").value;
  const email = document.getElementById("emailTarget").value;
  if (!content || !email) return alert("ë‚´ìš©ê³¼ ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  const lines = content.split("\n");
  lines.forEach((line, i) => pdf.text(line, 10, 10 + i * 10));
  pdf.save("AgriNexus_Document.pdf");
  document.getElementById("emailSendStatus").innerText = `âœ… PDF ì €ì¥ ì™„ë£Œ ë° ${email}ë¡œ ë©”ì¼ ì „ì†¡ë¨ (ì‹œë®¬ë ˆì´ì…˜)`;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ“Š ìˆ˜ì¶œì… ìš”ê±´ ë¹„êµ PDF ë³´ê³ ì„œ ì €ì¥</h2>
<button onclick="saveExportComparePDF()" style="padding:8px 16px;">ğŸ§¾ ë³´ê³ ì„œ PDF ì €ì¥</button>
<div id="exportPDFStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function saveExportComparePDF() {
  const content = document.getElementById("compareExportResult").innerText;
  if (!content) return alert("ë¨¼ì € êµ­ê°€ ë¹„êµë¥¼ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.");
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  const lines = content.split("\n");
  lines.forEach((line, i) => pdf.text(line, 10, 10 + i * 10));
  pdf.save("Export_Requirement_Report.pdf");
  document.getElementById("exportPDFStatus").innerText = "âœ… PDF ë³´ê³ ì„œ ì €ì¥ ì™„ë£Œ";
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ§¾ ê³„ì•½ì„œ ìë™ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ</h2>
<input type="text" id="contractVersionInput" placeholder="ë²„ì „ëª… (ì˜ˆ: v1.0, 2024-01)" style="padding:8px;width:200px;" />
<textarea id="contractVersionContent" placeholder="ê³„ì•½ì„œ ë‚´ìš©" style="width:100%;height:80px;padding:8px;"></textarea>
<button onclick="saveContractVersion()" style="padding:8px 16px;">ğŸ’¾ ì €ì¥</button>
<select id="versionSelect" onchange="loadContractVersion()" style="margin-left:10px;padding:6px;"></select>
<div id="versionStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function saveContractVersion() {
  const key = document.getElementById("contractVersionInput").value.trim();
  const content = document.getElementById("contractVersionContent").value.trim();
  if (!key || !content) return alert("ë²„ì „ëª…ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  const versions = JSON.parse(localStorage.getItem("contract_versions") || "{}");
  versions[key] = content;
  localStorage.setItem("contract_versions", JSON.stringify(versions));
  updateVersionList();
  document.getElementById("versionStatus").innerText = `âœ… ${key} ì €ì¥ ì™„ë£Œ`;
}

function updateVersionList() {
  const versions = JSON.parse(localStorage.getItem("contract_versions") || "{}");
  const select = document.getElementById("versionSelect");
  select.innerHTML = "";
  Object.keys(versions).forEach(k => {
    const opt = document.createElement("option");
    opt.value = k;
    opt.textContent = k;
    select.appendChild(opt);
  });
}

function loadContractVersion() {
  const key = document.getElementById("versionSelect").value;
  const versions = JSON.parse(localStorage.getItem("contract_versions") || "{}");
  document.getElementById("contractVersionContent").value = versions[key] || "";
  document.getElementById("versionStatus").innerText = `ğŸ“‚ ${key} ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ`;
}

window.onload = updateVersionList;
</script>

<hr style="margin:40px 0;">
<h2>ğŸŒ ì‚¬ìš©ì ìœ„ì¹˜ ê¸°ë°˜ ì½˜í…ì¸  ìë™ ë…¸ì¶œ</h2>
<button onclick="detectAndShowLocale()" style="padding:8px 16px;">ğŸŒ ì§€ì—­ ì½˜í…ì¸  í‘œì‹œ</button>
<div id="localeContent" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function detectAndShowLocale() {
  const res = await fetch("https://ipapi.co/json/");
  const data = await res.json();
  const country = data.country_name;
  let message = "ğŸŒ ê¸€ë¡œë²Œ ì´ìš©ìì…ë‹ˆë‹¤. ì˜ì–´ í˜ì´ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
  if (country === "Korea") message = "ğŸ‡°ğŸ‡· í•œêµ­ ì‚¬ìš©ìì…ë‹ˆë‹¤. í•œêµ­ì–´ ì½˜í…ì¸ ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
  else if (country === "Japan") message = "ğŸ‡¯ğŸ‡µ ì¼ë³¸ ì‚¬ìš©ìì…ë‹ˆë‹¤. ì¼ë³¸ì–´ ì½˜í…ì¸ ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
  else if (country === "China") message = "ğŸ‡¨ğŸ‡³ ì¤‘êµ­ ì‚¬ìš©ìì…ë‹ˆë‹¤. ì¤‘êµ­ì–´ ì½˜í…ì¸ ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
  document.getElementById("localeContent").innerText = message;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ—‚ PDF ìë™ ë¶„ë¥˜ ë° ë³´ê´€ ì‹œìŠ¤í…œ (ì‹œë®¬ë ˆì´ì…˜)</h2>
<select id="pdfType" style="padding:6px;">
  <option value="contract">ê³„ì•½ì„œ</option>
  <option value="quote">ê²¬ì ì„œ</option>
</select>
<textarea id="pdfContentInput" placeholder="PDF ë‚´ìš© ì…ë ¥" style="width:100%;height:80px;padding:8px;"></textarea>
<button onclick="archivePDFByType()" style="padding:8px 16px;">ğŸ“¦ ì €ì¥</button>
<div id="archiveStatus" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function archivePDFByType() {
  const type = document.getElementById("pdfType").value;
  const content = document.getElementById("pdfContentInput").value.trim();
  if (!content) return alert("ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
  const key = `pdf_${type}_archive`;
  const list = JSON.parse(localStorage.getItem(key) || "[]");
  list.push({ content, saved: new Date().toISOString() });
  localStorage.setItem(key, JSON.stringify(list));
  document.getElementById("archiveStatus").innerText = `âœ… ${type === "contract" ? "ê³„ì•½ì„œ" : "ê²¬ì ì„œ"} ë³´ê´€ ì™„ë£Œ`;
}
</script>


<hr style="margin:40px 0;">
<h2>ğŸ“¦ ì €ì¥ëœ PDF ê²€ìƒ‰ ë° ë‹¤ìš´ë¡œë“œ</h2>
<select id="pdfSearchType" style="padding:6px;">
  <option value="contract">ê³„ì•½ì„œ</option>
  <option value="quote">ê²¬ì ì„œ</option>
</select>
<button onclick="showSavedPDFs()" style="padding:8px 16px;">ğŸ“‚ ì €ì¥ ëª©ë¡ ë³´ê¸°</button>
<div id="pdfArchiveList" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function showSavedPDFs() {
  const type = document.getElementById("pdfSearchType").value;
  const key = `pdf_${type}_archive`;
  const list = JSON.parse(localStorage.getItem(key) || "[]");
  if (!list.length) {
    document.getElementById("pdfArchiveList").innerText = "âš ï¸ ì €ì¥ëœ ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤.";
    return;
  }
  let out = list.map((e, i) => `ğŸ“„ ${type} ${i+1} (ì €ì¥ì‹œê°: ${e.saved})\në‚´ìš© ë¯¸ë¦¬ë³´ê¸°: ${e.content.substring(0, 50)}...`).join("\n");
  document.getElementById("pdfArchiveList").innerText = out;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸ” ê³„ì•½ì„œ ë²„ì „ ë³€ê²½ ì´ë ¥ ê¸°ë¡</h2>
<button onclick="logVersionHistory()" style="padding:8px 16px;">ğŸ“ ì´ë ¥ ê¸°ë¡ ì¶”ê°€</button>
<div id="versionLogOutput" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
function logVersionHistory() {
  const version = document.getElementById("contractVersionInput").value.trim();
  const time = new Date().toISOString();
  const history = JSON.parse(localStorage.getItem("contract_version_log") || "[]");
  history.push({ version, time });
  localStorage.setItem("contract_version_log", JSON.stringify(history));
  const log = history.map(e => `ğŸ“Œ ${e.version} ì €ì¥ë¨ â†’ ${e.time}`).join("\n");
  document.getElementById("versionLogOutput").innerText = log;
}
</script>

<hr style="margin:40px 0;">
<h2>ğŸŒ ì§€ì—­ ê¸°ë°˜ ê°€ê²©/ì •ì±… ìë™ ì¶”ì²œ</h2>
<button onclick="suggestGeoPricing()" style="padding:8px 16px;">ğŸ“ˆ ì§€ì—­ ì •ì±… ì œì•ˆ</button>
<div id="geoPolicySuggestion" style="margin-top:10px;font-size:0.9rem;"></div>

<script>
async function suggestGeoPricing() {
  document.getElementById("geoPolicySuggestion").innerText = "ğŸ“¡ ìœ„ì¹˜ ê¸°ë°˜ ì •ì±… ë¶„ì„ ì¤‘...";
  const res = await fetch("https://ipapi.co/json/");
  const data = await res.json();
  const country = data.country_name;
  const prompt = `í˜„ì¬ ì‚¬ìš©ìê°€ ìœ„ì¹˜í•œ ${country}ì— ëŒ€í•´\n- ì¼ë°˜ì ì¸ ìˆ˜ì¶œì… ë¹„ìš©\n- ë¬¸ì„œ ìš”ê±´\n- í†µê´€ ì ˆì°¨\n- ì¶”ì²œ ë¬¼ë¥˜ ì •ì±…ì„ ìš”ì•½í•´ ì£¼ì„¸ìš”.`;
  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer sk-abc123xyz456def...",
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }]
    })
  });
  const dataOut = await response.json();
  document.getElementById("geoPolicySuggestion").innerText = dataOut.choices[0].message.content;
}
</script>

</body>






























</html>
